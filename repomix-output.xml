This file is a merged representation of the entire codebase, combined into a single document by Repomix.

<file_summary>
This section contains a summary of this file.

<purpose>
This file contains a packed representation of the entire repository's contents.
It is designed to be easily consumable by AI systems for analysis, code review,
or other automated processes.
</purpose>

<file_format>
The content is organized as follows:
1. This summary section
2. Repository information
3. Directory structure
4. Repository files (if enabled)
5. Multiple file entries, each consisting of:
  - File path as an attribute
  - Full contents of the file
</file_format>

<usage_guidelines>
- This file should be treated as read-only. Any changes should be made to the
  original repository files, not this packed version.
- When processing this file, use the file path to distinguish
  between different files in the repository.
- Be aware that this file may contain sensitive information. Handle it with
  the same level of security as you would the original repository.
</usage_guidelines>

<notes>
- Some files may have been excluded based on .gitignore rules and Repomix's configuration
- Binary files are not included in this packed representation. Please refer to the Repository Structure section for a complete list of file paths, including binary files
- Files matching patterns in .gitignore are excluded
- Files matching default ignore patterns are excluded
- Files are sorted by Git change count (files with more changes are at the bottom)
</notes>

</file_summary>

<directory_structure>
.gitignore
psy-admin/.gitignore
psy-admin/eslint.config.mjs
psy-admin/package.json
psy-admin/README.md
psy-admin/sanity.cli.ts
psy-admin/sanity.config.ts
psy-admin/schemaTypes/author.ts
psy-admin/schemaTypes/blockContent.ts
psy-admin/schemaTypes/category.ts
psy-admin/schemaTypes/index.ts
psy-admin/schemaTypes/post.ts
psy-admin/static/.gitkeep
psy-admin/tsconfig.json
psy-front/.gitignore
psy-front/app/[lang]/bookmarks/page.tsx
psy-front/app/[lang]/loading.tsx
psy-front/app/[lang]/menu/page.tsx
psy-front/app/[lang]/page.tsx
psy-front/app/[lang]/post/[slug]/loading.tsx
psy-front/app/[lang]/post/[slug]/page.tsx
psy-front/app/[lang]/post/[slug]/TranslationProvider.tsx
psy-front/app/[lang]/search/page.tsx
psy-front/app/api/algolia-sync/route.ts
psy-front/app/favicon.ico
psy-front/app/globals.css
psy-front/app/layout.tsx
psy-front/app/not-found.tsx
psy-front/components/article/ArticleActions.tsx
psy-front/components/BottomBar.tsx
psy-front/components/feed/SearchAndFeed.tsx
psy-front/components/LanguageSwitcher.tsx
psy-front/components/search/HomeSearchTrigger.tsx
psy-front/components/search/SearchClient.tsx
psy-front/components/ThemeProvider.tsx
psy-front/components/ThemeToggle.tsx
psy-front/components/ui/BookmarkButton.tsx
psy-front/components/ui/BottomBar.tsx
psy-front/components/ui/Header.tsx
psy-front/components/ui/ProgressBar.tsx
psy-front/components/ui/ThemeToggle.tsx
psy-front/eslint.config.mjs
psy-front/hooks/useBookmarks.ts
psy-front/lib/haptic.ts
psy-front/lib/queries.ts
psy-front/lib/sanity.ts
psy-front/middleware.ts
psy-front/next.config.ts
psy-front/package.json
psy-front/postcss.config.mjs
psy-front/public/favicon.ico
psy-front/public/file.svg
psy-front/public/globe.svg
psy-front/public/next.svg
psy-front/public/vercel.svg
psy-front/public/window.svg
psy-front/README.md
psy-front/tsconfig.json
README.md
</directory_structure>

<files>
This section contains the contents of the repository's files.

<file path=".gitignore">
# Logs
logs
*.log
npm-debug.log*
yarn-debug.log*
yarn-error.log*
lerna-debug.log*

# Diagnostic reports (https://nodejs.org/api/report.html)
report.[0-9]*.[0-9]*.[0-9]*.[0-9]*.json

# Runtime data
pids
*.pid
*.seed
*.pid.lock

# Directory for instrumented libs generated by jscoverage/JSCover
lib-cov

# Coverage directory used by tools like istanbul
coverage
*.lcov

# nyc test coverage
.nyc_output

# Grunt intermediate storage (https://gruntjs.com/creating-plugins#storing-task-files)
.grunt

# Bower dependency directory (https://bower.io/)
bower_components

# node-waf configuration
.lock-wscript

# Compiled binary addons (https://nodejs.org/api/addons.html)
build/Release

# Dependency directories
node_modules/
jspm_packages/

# Snowpack dependency directory (https://snowpack.dev/)
web_modules/

# TypeScript cache
*.tsbuildinfo

# Optional npm cache directory
.npm

# Optional eslint cache
.eslintcache

# Optional stylelint cache
.stylelintcache

# Optional REPL history
.node_repl_history

# Output of 'npm pack'
*.tgz

# Yarn Integrity file
.yarn-integrity

# dotenv environment variable files
.env
.env.*
!.env.example

# parcel-bundler cache (https://parceljs.org/)
.cache
.parcel-cache

# Next.js build output
.next
out

# Nuxt.js build / generate output
.nuxt
dist

# Gatsby files
.cache/
# Comment in the public line in if your project uses Gatsby and not Next.js
# https://nextjs.org/blog/next-9-1#public-directory-support
# public

# vuepress build output
.vuepress/dist

# vuepress v2.x temp and cache directory
.temp
.cache

# Sveltekit cache directory
.svelte-kit/

# vitepress build output
**/.vitepress/dist

# vitepress cache directory
**/.vitepress/cache

# Docusaurus cache and generated files
.docusaurus

# Serverless directories
.serverless/

# FuseBox cache
.fusebox/

# DynamoDB Local files
.dynamodb/

# Firebase cache directory
.firebase/

# TernJS port file
.tern-port

# Stores VSCode versions used for testing VSCode extensions
.vscode-test

# yarn v3
.pnp.*
.yarn/*
!.yarn/patches
!.yarn/plugins
!.yarn/releases
!.yarn/sdks
!.yarn/versions

# Vite logs files
vite.config.js.timestamp-*
vite.config.ts.timestamp-*
</file>

<file path="psy-admin/.gitignore">
# See https://help.github.com/articles/ignoring-files/ for more about ignoring files.

# Dependencies
/node_modules
/.pnp
.pnp.js

# Compiled Sanity Studio
/dist

# Temporary Sanity runtime, generated by the CLI on every dev server start
/.sanity

# Logs
/logs
*.log

# Coverage directory used by testing tools
/coverage

# Misc
.DS_Store
*.pem

# Typescript
*.tsbuildinfo

# Dotenv and similar local-only files
*.local
</file>

<file path="psy-admin/eslint.config.mjs">
import studio from '@sanity/eslint-config-studio'

export default [...studio]
</file>

<file path="psy-admin/README.md">
# Sanity Blogging Content Studio

Congratulations, you have now installed the Sanity Content Studio, an open-source real-time content editing environment connected to the Sanity backend.

Now you can do the following things:

- [Read ‚Äúgetting started‚Äù in the docs](https://www.sanity.io/docs/introduction/getting-started?utm_source=readme)
- Check out the example frontend: [React/Next.js](https://github.com/sanity-io/tutorial-sanity-blog-react-next)
- [Read the blog post about this template](https://www.sanity.io/blog/build-your-own-blog-with-sanity-and-next-js?utm_source=readme)
- [Join the Sanity community](https://www.sanity.io/community/join?utm_source=readme)
- [Extend and build plugins](https://www.sanity.io/docs/content-studio/extending?utm_source=readme)
</file>

<file path="psy-admin/schemaTypes/author.ts">
import {defineField, defineType} from 'sanity'

export default defineType({
  name: 'author',
  title: 'Author',
  type: 'document',
  fields: [
    defineField({
      name: 'name',
      title: 'Name',
      type: 'string',
    }),
    defineField({
      name: 'slug',
      title: 'Slug',
      type: 'slug',
      options: {
        source: 'name',
        maxLength: 96,
      },
    }),
    defineField({
      name: 'image',
      title: 'Image',
      type: 'image',
      options: {
        hotspot: true,
      },
    }),
    defineField({
      name: 'bio',
      title: 'Bio',
      type: 'array',
      of: [
        {
          title: 'Block',
          type: 'block',
          styles: [{title: 'Normal', value: 'normal'}],
          lists: [],
        },
      ],
    }),
  ],
  preview: {
    select: {
      title: 'name',
      media: 'image',
    },
  },
})
</file>

<file path="psy-admin/schemaTypes/blockContent.ts">
import {defineType, defineArrayMember} from 'sanity'

/**
 * This is the schema definition for the rich text fields used for
 * for this blog studio. When you import it in schemas.js it can be
 * reused in other parts of the studio with:
 *  {
 *    name: 'someName',
 *    title: 'Some title',
 *    type: 'blockContent'
 *  }
 */
export default defineType({
  title: 'Block Content',
  name: 'blockContent',
  type: 'array',
  of: [
    defineArrayMember({
      title: 'Block',
      type: 'block',
      // Styles let you set what your user can mark up blocks with. These
      // correspond with HTML tags, but you can set any title or value
      // you want and decide how you want to deal with it where you want to
      // use your content.
      styles: [
        {title: 'Normal', value: 'normal'},
        {title: 'H1', value: 'h1'},
        {title: 'H2', value: 'h2'},
        {title: 'H3', value: 'h3'},
        {title: 'H4', value: 'h4'},
        {title: 'Quote', value: 'blockquote'},
      ],
      lists: [{title: 'Bullet', value: 'bullet'}],
      // Marks let you mark up inline text in the block editor.
      marks: {
        // Decorators usually describe a single property ‚Äì e.g. a typographic
        // preference or highlighting by editors.
        decorators: [
          {title: 'Strong', value: 'strong'},
          {title: 'Emphasis', value: 'em'},
        ],
        // Annotations can be any object structure ‚Äì e.g. a link or a footnote.
        annotations: [
          {
            title: 'URL',
            name: 'link',
            type: 'object',
            fields: [
              {
                title: 'URL',
                name: 'href',
                type: 'url',
              },
            ],
          },
        ],
      },
    }),
    // You can add additional types here. Note that you can't use
    // primitive types such as 'string' and 'number' in the same array
    // as a block type.
    defineArrayMember({
      type: 'image',
      options: {hotspot: true},
    }),
  ],
})
</file>

<file path="psy-admin/schemaTypes/category.ts">
import {defineField, defineType} from 'sanity'

export default defineType({
  name: 'category',
  title: 'Category',
  type: 'document',
  fields: [
    defineField({
      name: 'title',
      title: 'Title',
      type: 'string',
    }),
    defineField({
      name: 'description',
      title: 'Description',
      type: 'text',
    }),
  ],
})
</file>

<file path="psy-admin/schemaTypes/index.ts">
import blockContent from './blockContent'
import category from './category'
import post from './post'
import author from './author'

export const schemaTypes = [post, author, category, blockContent]
</file>

<file path="psy-admin/static/.gitkeep">
Files placed here will be served by the Sanity server under the `/static`-prefix
</file>

<file path="psy-admin/tsconfig.json">
{
  "compilerOptions": {
    "target": "ES2017",
    "lib": ["dom", "dom.iterable", "esnext"],
    "allowJs": true,
    "skipLibCheck": true,
    "strict": true,
    "forceConsistentCasingInFileNames": true,
    "module": "Preserve",
    "moduleDetection": "force",
    "isolatedModules": true,
    "jsx": "preserve",
    "incremental": true
  },
  "include": ["**/*.ts", "**/*.tsx"],
  "exclude": ["node_modules"]
}
</file>

<file path="psy-front/.gitignore">
# See https://help.github.com/articles/ignoring-files/ for more about ignoring files.

# dependencies
/node_modules
/.pnp
.pnp.*
.yarn/*
!.yarn/patches
!.yarn/plugins
!.yarn/releases
!.yarn/versions

# testing
/coverage

# next.js
/.next/
/out/

# production
/build

# misc
.DS_Store
*.pem

# debug
npm-debug.log*
yarn-debug.log*
yarn-error.log*
.pnpm-debug.log*

# env files (can opt-in for committing if needed)
.env*

# vercel
.vercel

# typescript
*.tsbuildinfo
next-env.d.ts
</file>

<file path="psy-front/app/[lang]/loading.tsx">
// === –ù–ê–ß–ê–õ–û –ë–õ–û–ö–ê: Home Page Loading Skeleton ===
export default function Loading() {
  return (
    <main id="home-skeleton" className="animate-pulse">
      <div className="layout-container space-y-10">
        
        {/* –®–∞–ø–∫–∞ –∏ –ø–æ–∏—Å–∫ */}
        <section id="skeleton-hero" className="space-y-6">
          <div className="space-y-3">
            <div className="h-12 w-3/4 md:w-1/2 bg-gray-200 dark:bg-zinc-800 rounded-2xl"></div>
            <div className="h-6 w-1/2 md:w-1/3 bg-gray-200 dark:bg-zinc-800 rounded-xl"></div>
          </div>
          <div className="h-14 w-full bg-gray-200 dark:bg-zinc-800 rounded-3xl"></div>
          <div className="flex gap-3 overflow-hidden">
            {[1, 2, 3, 4, 5].map((i) => (
              <div key={i} className="h-10 w-28 shrink-0 bg-gray-200 dark:bg-zinc-800 rounded-full"></div>
            ))}
          </div>
        </section>

        {/* –°–µ—Ç–∫–∞ —Å—Ç–∞—Ç–µ–π */}
        <section id="skeleton-articles" className="space-y-8">
          <div className="h-8 w-48 bg-gray-200 dark:bg-zinc-800 rounded-xl"></div>
          <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
            {[1, 2, 3, 4].map((i) => (
              <div key={i} className="card-editorial flex flex-col h-full border border-gray-100 dark:border-zinc-800">
                <div className="w-full h-48 rounded-2xl bg-gray-200 dark:bg-zinc-800 mb-5"></div>
                <div className="h-4 w-1/3 bg-gray-200 dark:bg-zinc-800 rounded-md mb-3"></div>
                <div className="h-6 w-full bg-gray-200 dark:bg-zinc-800 rounded-lg mb-2"></div>
                <div className="h-6 w-4/5 bg-gray-200 dark:bg-zinc-800 rounded-lg mb-4"></div>
                <div className="mt-auto pt-4 border-t border-gray-100 dark:border-zinc-800">
                  <div className="h-4 w-1/2 bg-gray-200 dark:bg-zinc-800 rounded-md"></div>
                </div>
              </div>
            ))}
          </div>
        </section>

      </div>
    </main>
  );
}
// === –ö–û–ù–ï–¶ –ë–õ–û–ö–ê ===
</file>

<file path="psy-front/app/[lang]/menu/page.tsx">
// === –ù–ê–ß–ê–õ–û –ë–õ–û–ö–ê: –°—Ç—Ä–∞–Ω–∏—Ü–∞ –ú–µ–Ω—é ===
"use client";

import { useState, useEffect } from "react";
import { useTheme } from "next-themes";
import Link from "next/link";
import { usePathname, useRouter } from "next/navigation";
import { triggerHaptic } from "@/lib/haptic";

// 1. –°–æ–∑–¥–∞–µ–º —Å–ª–æ–≤–∞—Ä—å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
const dictionary = {
  ru: {
    title: "–ú–µ–Ω—é",
    settings: "–ù–∞—Å—Ç—Ä–æ–π–∫–∏",
    darkTheme: "–¢–µ–º–Ω–∞—è —Ç–µ–º–∞",
    language: "–Ø–∑—ã–∫",
    categories: "–ö–∞—Ç–µ–≥–æ—Ä–∏–∏",
    catList: ["–û—Ç–Ω–æ—à–µ–Ω–∏—è", "–í—ã–≥–æ—Ä–∞–Ω–∏–µ", "–°–∞–º–æ–æ—Ü–µ–Ω–∫–∞", "–ö–∞—Ä—å–µ—Ä–∞"]
  },
  en: {
    title: "Menu",
    settings: "Settings",
    darkTheme: "Dark mode",
    language: "Language",
    categories: "Categories",
    catList: ["Relationships", "Burnout", "Self-esteem", "Career"]
  },
  ua: {
    title: "–ú–µ–Ω—é",
    settings: "–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è",
    darkTheme: "–¢–µ–º–Ω–∞ —Ç–µ–º–∞",
    language: "–ú–æ–≤–∞",
    categories: "–ö–∞—Ç–µ–≥–æ—Ä—ñ—ó",
    catList: ["–í—ñ–¥–Ω–æ—Å–∏–Ω–∏", "–í–∏–≥–æ—Ä–∞–Ω–Ω—è", "–°–∞–º–æ–æ—Ü—ñ–Ω–∫–∞", "–ö–∞—Ä'—î—Ä–∞"]
  },
  pl: {
    title: "Menu",
    settings: "Ustawienia",
    darkTheme: "Tryb ciemny",
    language: "Jƒôzyk",
    categories: "Kategorie",
    catList: ["Relacje", "Wypalenie", "Samoocena", "Kariera"]
  },
  de: {
    title: "Men√º",
    settings: "Einstellungen",
    darkTheme: "Dunkler Modus",
    language: "Sprache",
    categories: "Kategorien",
    catList: ["Beziehungen", "Burnout", "Selbstwertgef√ºhl", "Karriere"]
  }
};

export default function MenuPage() {
  const [mounted, setMounted] = useState(false);
  const { theme, setTheme, systemTheme } = useTheme();
  
  const pathname = usePathname();
  const router = useRouter();

  useEffect(() => {
    setMounted(true);
  }, []);

  const currentTheme = theme === "system" ? systemTheme : theme;

  const toggleTheme = () => {
    triggerHaptic('light');
    setTheme(currentTheme === "dark" ? "light" : "dark");
  };

  const currentLang = (pathname?.split("/")[1] || "ru") as keyof typeof dictionary;
  
  // 2. –î–æ—Å—Ç–∞–µ–º –Ω—É–∂–Ω—ã–µ —Å–ª–æ–≤–∞ –∏–∑ —Å–ª–æ–≤–∞—Ä—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —è–∑—ã–∫–∞
  const t = dictionary[currentLang] || dictionary.ru;

  const handleLanguageChange = (e: React.ChangeEvent<HTMLSelectElement>) => {
    triggerHaptic('light');
    const locale = e.target.value;
    
    if (!pathname) {
      router.push(`/${locale}`);
      return;
    }
    
    const segments = pathname.split("/");
    segments[1] = locale;
    router.push(segments.join("/"));
    router.refresh();
  };

  return (
    <main id="menu-page">
      <div className="layout-container space-y-8">
        
        {/* –ò—Å–ø–æ–ª—å–∑—É–µ–º —Å–ª–æ–≤–∞—Ä—å –¥–ª—è –∑–∞–≥–æ–ª–æ–≤–∫–∞ */}
        <h1 className="text-4xl md:text-5xl font-black text-gray-900 dark:text-zinc-50 tracking-tight px-2">
          {t.title}
        </h1>

        <section id="menu-settings" className="card-editorial space-y-6">
          <h2 className="text-sm font-bold text-gray-400 uppercase tracking-wider">
            {t.settings}
          </h2>

          <div className="flex items-center justify-between">
            <span className="text-lg font-medium text-gray-900 dark:text-white">
              {t.darkTheme}
            </span>
            
            {!mounted ? (
              <div className="w-14 h-8 bg-gray-200 dark:bg-zinc-700 rounded-full animate-pulse" />
            ) : (
              <button
                onClick={toggleTheme}
                className={`w-14 h-8 rounded-full relative transition-colors duration-300 focus:outline-none ${
                  currentTheme === "dark" ? "bg-blue-600" : "bg-gray-300 dark:bg-zinc-600"
                }`}
                aria-label="Toggle theme"
              >
                <span
                  className={`absolute top-1 left-1 w-6 h-6 bg-white rounded-full shadow-sm transition-transform duration-300 ${
                    currentTheme === "dark" ? "translate-x-6" : "translate-x-0"
                  }`}
                />
              </button>
            )}
          </div>

          <div className="h-px bg-gray-100 dark:bg-zinc-800 w-full" />

          <div className="flex items-center justify-between">
            <span className="text-lg font-medium text-gray-900 dark:text-white">
              {t.language}
            </span>
            <select
              onChange={handleLanguageChange}
              value={currentLang}
              className="bg-gray-50 dark:bg-zinc-800 text-gray-900 dark:text-white border border-gray-200 dark:border-zinc-700 rounded-xl px-4 py-2 outline-none focus:ring-2 focus:ring-blue-500 font-medium appearance-none cursor-pointer"
            >
              <option value="ru">–†—É—Å—Å–∫–∏–π (RU)</option>
              <option value="en">English (EN)</option>
              <option value="ua">–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞ (UA)</option>
              <option value="pl">Polski (PL)</option>
              <option value="de">Deutsch (DE)</option>
            </select>
          </div>
        </section>

        <section id="menu-categories" className="card-editorial space-y-4">
          <h2 className="text-sm font-bold text-gray-400 uppercase tracking-wider mb-2">
            {t.categories}
          </h2>
          <nav className="flex flex-col space-y-5">
            {/* –û—Ç—Ä–∏—Å–æ–≤—ã–≤–∞–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏–∑ —Å–ª–æ–≤–∞—Ä—è */}
            {t.catList.map((item, index) => {
              // –î–ª—è —Å—Å—ã–ª–∫–∏ –±–µ—Ä–µ–º –∞–Ω–≥–ª–∏–π—Å–∫–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ (–∏–ª–∏ —Å–ª–∞–≥), —á—Ç–æ–±—ã URL –∫–∞—Ç–µ–≥–æ—Ä–∏–π –≤—Å–µ–≥–¥–∞ —Ä–∞–±–æ—Ç–∞–ª,
              // –Ω–æ —Ç—É—Ç –¥–ª—è –ø—Ä–æ—Å—Ç–æ—Ç—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º –∏–Ω–¥–µ–∫—Å –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –º–∞—Å—Å–∏–≤–∞ –∏–ª–∏ —Ä—É—Å—Å–∫–∏–π –∫–ª—é—á, 
              // –µ—Å–ª–∏ —É —Ç–µ–±—è —Å–ª–∞–≥–∏ –≤ –±–∞–∑–µ –Ω–∞ —Ä—É—Å—Å–∫–æ–º. –ü–æ–∫–∞ –æ—Å—Ç–∞–≤–ª—è–µ–º –≥–µ–Ω–µ—Ä–∞—Ü–∏—é —Å–ª–∞–≥–∞ –∫–∞–∫ –±—ã–ª–∞:
              const slug = dictionary.ru.catList[index].toLowerCase(); 
              return (
                <Link
                  key={item}
                  href={`/${currentLang}/category/${slug}`}
                  className="text-xl font-bold text-gray-900 dark:text-white hover:text-blue-600 dark:hover:text-blue-400 transition-colors"
                  onClick={() => triggerHaptic('light')}
                >
                  {item}
                </Link>
              );
            })}
          </nav>
        </section>

      </div>
    </main>
  );
}
// === –ö–û–ù–ï–¶ –ë–õ–û–ö–ê ===
</file>

<file path="psy-front/app/[lang]/page.tsx">
import { client } from "@/lib/sanity";
import { articlesQuery } from "@/lib/queries";
import SearchAndFeed from "@/components/feed/SearchAndFeed";

export const revalidate = 60; 

const translations = {
  ru: { h1: "–ü–æ–∑–Ω–∞–π —Å–µ–±—è.", sub: "–ù–∞—É—á–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –∫ –ø—Å–∏—Ö–æ–ª–æ–≥–∏–∏.", err: "–£–ø—Å! –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞", errSub: "–ü—Ä–æ–≤–µ—Ä—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ Sanity –∏–ª–∏ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ." },
  en: { h1: "Know yourself.", sub: "Scientific approach to psychology.", err: "Oops! Database unavailable", errSub: "Check Sanity settings or connection." },
  ua: { h1: "–ü—ñ–∑–Ω–∞–π —Å–µ–±–µ.", sub: "–ù–∞—É–∫–æ–≤–∏–π –ø—ñ–¥—Ö—ñ–¥ –¥–æ –ø—Å–∏—Ö–æ–ª–æ–≥—ñ—ó.", err: "–£–ø—Å! –ë–∞–∑–∞ –¥–∞–Ω–∏—Ö –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞", errSub: "–ü–µ—Ä–µ–≤—ñ—Ä –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è Sanity –∞–±–æ –∑'—î–¥–Ω–∞–Ω–Ω—è." },
  pl: { h1: "Poznaj siebie.", sub: "Naukowe podej≈õcie do psychologii.", err: "Ups! Baza danych niedostƒôpna", errSub: "Sprawd≈∫ ustawienia Sanity lub po≈ÇƒÖczenie." },
  de: { h1: "Erkenne dich selbst.", sub: "Wissenschaftlicher Ansatz zur Psychologie.", err: "Hoppla! Datenbank nicht verf√ºgbar", errSub: "Sanity-Einstellungen oder Verbindung pr√ºfen." },
};

interface Props {
  params: Promise<{ lang: string }>;
}

export default async function HomePage(props: Props) {
  const params = await props.params;
  const lang = (params.lang || "ru") as keyof typeof translations;
  const t = translations[lang] || translations.ru;

  let articles = [];
  let errorOccurred = false;

  try {
    // –í articlesQuery –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Ñ–∏–ª—å—Ç—Ä –ø–æ language == $lang
    articles = await client.fetch(articlesQuery, { lang });
  } catch (error) {
    console.error("Sanity fetch error:", error);
    errorOccurred = true;
  }

  return (
    <main id="home-main">
      <div id="home-container" className="layout-container space-y-10">
        
        <section id="hero-section" className="space-y-6">
          <div className="space-y-2">
            <h1 className="text-4xl md:text-5xl font-black tracking-tight text-gray-900 dark:text-zinc-50">
              {t.h1}
            </h1>
            <p className="text-lg text-gray-600 dark:text-gray-400 font-medium">
              {t.sub}
            </p>
          </div>
        </section>

        {errorOccurred ? (
          <div id="error-state" className="p-10 border-2 border-dashed border-zinc-200 dark:border-zinc-800 rounded-3xl text-center">
            <p className="text-red-500 font-bold mb-2">{t.err}</p>
            <p className="text-sm text-gray-500">{t.errSub}</p>
          </div>
        ) : (
          /* –ü–µ—Ä–µ–¥–∞–µ–º lang –≤–Ω—É—Ç—Ä—å, —á—Ç–æ–±—ã —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Ç–µ–≥–∞–º —Ç–æ–∂–µ –∑–Ω–∞–ª–∞ –ø—Ä–æ —è–∑—ã–∫ */
          <SearchAndFeed initialArticles={articles} lang={lang} />
        )}

      </div>
    </main>
  );
}
</file>

<file path="psy-front/app/[lang]/post/[slug]/loading.tsx">
// === –ù–ê–ß–ê–õ–û –ë–õ–û–ö–ê: Post Page Loading Skeleton ===
export default function Loading() {
  return (
    <main id="post-skeleton" className="animate-pulse">
      <article className="layout-container max-w-3xl mx-auto space-y-8">
        
        {/* –•–ª–µ–±–Ω—ã–µ –∫—Ä–æ—à–∫–∏ */}
        <div className="h-4 w-32 bg-gray-200 dark:bg-zinc-800 rounded-md mb-8"></div>
        
        {/* –ó–∞–≥–æ–ª–æ–≤–æ–∫ */}
        <div className="space-y-3 mb-6">
          <div className="h-10 md:h-12 w-full bg-gray-200 dark:bg-zinc-800 rounded-xl"></div>
          <div className="h-10 md:h-12 w-4/5 bg-gray-200 dark:bg-zinc-800 rounded-xl"></div>
        </div>

        {/* –ú–µ—Ç–∞-—Ç–µ–≥–∏ */}
        <div className="flex gap-4 mb-10">
          <div className="h-6 w-24 bg-gray-200 dark:bg-zinc-800 rounded-full"></div>
          <div className="h-6 w-20 bg-gray-200 dark:bg-zinc-800 rounded-md"></div>
        </div>

        {/* –ì–ª–∞–≤–Ω–∞—è –∫–∞—Ä—Ç–∏–Ω–∫–∞ */}
        <div className="w-full aspect-video rounded-3xl bg-gray-200 dark:bg-zinc-800 mb-12"></div>

        {/* –¢–µ–∫—Å—Ç (–∏–º–∏—Ç–∞—Ü–∏—è –∞–±–∑–∞—Ü–µ–≤) */}
        <div className="space-y-4">
          <div className="h-4 w-full bg-gray-200 dark:bg-zinc-800 rounded-md"></div>
          <div className="h-4 w-full bg-gray-200 dark:bg-zinc-800 rounded-md"></div>
          <div className="h-4 w-11/12 bg-gray-200 dark:bg-zinc-800 rounded-md"></div>
          <br />
          <div className="h-4 w-full bg-gray-200 dark:bg-zinc-800 rounded-md"></div>
          <div className="h-4 w-4/5 bg-gray-200 dark:bg-zinc-800 rounded-md"></div>
        </div>

      </article>
    </main>
  );
}
// === –ö–û–ù–ï–¶ –ë–õ–û–ö–ê ===
</file>

<file path="psy-front/app/[lang]/post/[slug]/TranslationProvider.tsx">
"use client";

import { useEffect } from "react";

interface Props {
  translations: Record<string, string>;
  currentLang: string;
}

export default function TranslationProvider({ translations, currentLang }: Props) {
  useEffect(() => {
    // –ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–±—ã—Ç–∏–µ —Å –ø–µ—Ä–µ–≤–æ–¥–∞–º–∏ –≤ –æ–∫–Ω–æ –±—Ä–∞—É–∑–µ—Ä–∞
    const event = new CustomEvent("set-article-translations", { 
      detail: translations 
    });
    window.dispatchEvent(event);

    // –ö–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É—Ö–æ–¥–∏—Ç —Å–æ —Å—Ç–∞—Ç—å–∏, —Å—Ç–∏—Ä–∞–µ–º —ç—Ç–∏ –¥–∞–Ω–Ω—ã–µ
    return () => {
      window.dispatchEvent(new CustomEvent("set-article-translations", { detail: null }));
    };
  }, [translations, currentLang]);

  return null; // –û–Ω –Ω–µ –∏–º–µ–µ—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞, —Ç–æ–ª—å–∫–æ –ª–æ–≥–∏–∫–∞
}
</file>

<file path="psy-front/app/api/algolia-sync/route.ts">
// app/api/algolia-sync/route.ts
import { NextResponse } from 'next/server';
// –ò–º–µ–Ω–æ–≤–∞–Ω–Ω—ã–π –∏–º–ø–æ—Ä—Ç –¥–ª—è v5
import { algoliasearch } from 'algoliasearch';

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –∫–ª–∏–µ–Ω—Ç Algolia. 
// –í–ê–ñ–ù–û: –ó–¥–µ—Å—å –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º ADMIN_KEY, —Ç–∞–∫ –∫–∞–∫ –Ω–∞–º –Ω—É–∂–Ω—ã –ø—Ä–∞–≤–∞ –Ω–∞ –∑–∞–ø–∏—Å—å.
const client = algoliasearch(
  process.env.NEXT_PUBLIC_ALGOLIA_APP_ID!,
  process.env.ALGOLIA_ADMIN_KEY!
);

const indexName = 'posts_index';

export async function POST(req: Request) {
  try {
    // –ß–∏—Ç–∞–µ–º –¥–∞–Ω–Ω—ã–µ, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–∏—Å–ª–∞–ª Sanity Webhook
    const body = await req.json();

    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –∫ –Ω–∞–º –ø—Ä–∏—à–ª–∞ –∏–º–µ–Ω–Ω–æ —Å—Ç–∞—Ç—å—è, –∞ –Ω–µ –¥—Ä—É–≥–æ–π —Ç–∏–ø –¥–æ–∫—É–º–µ–Ω—Ç–∞
    if (body._type !== 'post') {
      return NextResponse.json({ message: 'Not a post, ignoring.' }, { status: 200 });
    }

    // –ï—Å–ª–∏ –¥–æ–∫—É–º–µ–Ω—Ç –±—ã–ª —É–¥–∞–ª–µ–Ω –≤ Sanity -> —É–¥–∞–ª—è–µ–º –µ–≥–æ –∏–∑ Algolia (–°–∏–Ω—Ç–∞–∫—Å–∏—Å v5)
    if (body._deleted) {
      await client.deleteObject({
        indexName: indexName,
        objectID: body._id
      });
      return NextResponse.json({ message: `Deleted document ${body._id} from Algolia` });
    }

    // –§–æ—Ä–º–∏—Ä—É–µ–º —á–∏—Å—Ç—É—é –∑–∞–ø–∏—Å—å –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –≤ Algolia
    const record = {
      objectID: body._id, // Algolia –û–ë–û–ñ–ê–ï–¢ –ø–æ–ª–µ objectID, —ç—Ç–æ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ
      title: body.title,
      slug: body.slug?.current || body.slug,
      category: body.category || "–°—Ç–∞—Ç—å—è",
    };

    // –°–æ—Ö—Ä–∞–Ω—è–µ–º/–û–±–Ω–æ–≤–ª—è–µ–º –∑–∞–ø–∏—Å—å –≤ Algolia (–°–∏–Ω—Ç–∞–∫—Å–∏—Å v5)
    await client.saveObject({
      indexName: indexName,
      body: record
    });

    return NextResponse.json({ success: true, message: `Document ${body._id} synced to Algolia` });
    
  } catch (error) {
    console.error('Algolia Sync Error:', error);
    return NextResponse.json({ success: false, message: 'Sync failed' }, { status: 500 });
  }
}
</file>

<file path="psy-front/components/BottomBar.tsx">
"use client";

import Link from "next/link";
import { usePathname } from "next/navigation";

// === –ù–ê–ß–ê–õ–û –ë–õ–û–ö–ê: –ú–û–ë–ò–õ–¨–ù–û–ï –ù–ò–ñ–ù–ï–ï –ú–ï–ù–Æ (BOTTOM BAR) ===
export default function BottomBar() {
  // usePathname –ø–æ–º–æ–≥–∞–µ—Ç –Ω–∞–º —É–∑–Ω–∞—Ç—å, –Ω–∞ –∫–∞–∫–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ –º—ã –Ω–∞—Ö–æ–¥–∏–º—Å—è, —á—Ç–æ–±—ã –ø–æ–¥—Å–≤–µ—Ç–∏—Ç—å –∞–∫—Ç–∏–≤–Ω—É—é –∏–∫–æ–Ω–∫—É
  const pathname = usePathname();

  // –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –Ω–∞—à–µ–≥–æ –º–µ–Ω—é (–ü—É–Ω–∫—Ç 5 –¢–ó)
  const navItems = [
    {
      id: "nav-home",
      label: "–ì–ª–∞–≤–Ω–∞—è",
      href: "/",
      // SVG –∏–∫–æ–Ω–∫–∞ –¥–æ–º–∏–∫–∞
      icon: (
        <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
          <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" />
        </svg>
      ),
    },
    {
      id: "nav-search",
      label: "–ü–æ–∏—Å–∫",
      href: "/search",
      icon: (
        <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
          <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
        </svg>
      ),
    },
    {
      id: "nav-bookmarks",
      label: "–ó–∞–∫–ª–∞–¥–∫–∏",
      href: "/bookmarks",
      icon: (
        <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
          <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-3.5L5 21V5z" />
        </svg>
      ),
    },
    {
      id: "nav-menu",
      label: "–ú–µ–Ω—é",
      href: "/menu",
      icon: (
        <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
          <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 6h16M4 12h16M4 18h16" />
        </svg>
      ),
    },
  ];

  return (
    // –ö–ª–∞—Å—Å md:hidden —Å–∫—Ä—ã–≤–∞–µ—Ç –ø–∞–Ω–µ–ª—å –Ω–∞ –ø–ª–∞–Ω—à–µ—Ç–∞—Ö –∏ –ü–ö
    // pb-safe (safe-area-inset-bottom) –Ω—É–∂–µ–Ω –¥–ª—è –∞–π—Ñ–æ–Ω–æ–≤ —Å "—á–µ–ª–æ—á–∫–æ–π" –≤–Ω–∏–∑—É —ç–∫—Ä–∞–Ω–∞
    <nav
      id="mobile-bottom-bar"
      className="md:hidden fixed bottom-0 left-0 w-full z-50 bg-white/90 dark:bg-[#0a0a0a]/90 backdrop-blur-md border-t border-gray-200 dark:border-gray-800 transition-colors duration-500 pb-[env(safe-area-inset-bottom)]"
    >
      <div className="flex justify-around items-center h-16">
        {navItems.map((item) => {
          const isActive = pathname === item.href;
          return (
            <Link
              key={item.id}
              id={item.id}
              href={item.href}
              className={`flex flex-col items-center justify-center w-full h-full space-y-1 transition-colors ${
                isActive
                  ? "text-blue-600 dark:text-blue-400"
                  : "text-gray-500 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-100"
              }`}
            >
              {item.icon}
              <span className="text-[10px] font-medium">{item.label}</span>
            </Link>
          );
        })}
      </div>
    </nav>
  );
}
// === –ö–û–ù–ï–¶ –ë–õ–û–ö–ê ===
</file>

<file path="psy-front/components/search/HomeSearchTrigger.tsx">
// === –ù–ê–ß–ê–õ–û –ë–õ–û–ö–ê: Home Search Trigger ===
"use client";

import { useRouter } from "next/navigation";
import { Search } from "lucide-react";

export default function HomeSearchTrigger() {
  const router = useRouter();

  return (
    <div 
      onClick={() => router.push('/search')} 
      className="relative w-full cursor-text group"
    >
      <div className="absolute inset-y-0 left-0 flex items-center pl-7 pointer-events-none text-gray-400 group-hover:text-blue-500 transition-colors">
        <Search size={20} />
      </div>
      <div className="w-full py-4 pl-14 pr-7 text-lg bg-gray-50 dark:bg-zinc-900 border border-gray-200 dark:border-zinc-800 text-gray-500 dark:text-zinc-400 rounded-full shadow-sm transition-all flex items-center">
        –ù–∞–π—Ç–∏ —Å—Ç–∞—Ç—å—é, —Ç–µ–º—É –∏–ª–∏ –∞–≤—Ç–æ—Ä–∞...
      </div>
    </div>
  );
}
// === –ö–û–ù–ï–¶ –ë–õ–û–ö–ê ===
</file>

<file path="psy-front/components/ThemeProvider.tsx">
"use client";

import { ThemeProvider as NextThemesProvider } from "next-themes";

export default function ThemeProvider({ children }: { children: React.ReactNode }) {
  return (
    <NextThemesProvider 
      attribute="class" 
      defaultTheme="system" 
      enableSystem
      disableTransitionOnChange // –í–∞–∂–Ω–æ: —É–±–∏—Ä–∞–µ—Ç –º–∏–∫—Ä–æ-–ª–∞–≥ –ø—Ä–∏ —Å–º–µ–Ω–µ —Å—Ç—Ä–∞–Ω–∏—Ü
    >
      {children}
    </NextThemesProvider>
  );
}
</file>

<file path="psy-front/components/ThemeToggle.tsx">
"use client";

import { useTheme } from "next-themes";
import { useEffect, useState } from "react";

// === –ù–ê–ß–ê–õ–û –ë–õ–û–ö–ê: –ö–ù–û–ü–ö–ê –ü–ï–†–ï–ö–õ–Æ–ß–ï–ù–ò–Ø –¢–ï–ú–´ ===
export default function ThemeToggle() {
  const { theme, setTheme } = useTheme();
  const [mounted, setMounted] = useState(false);

  useEffect(() => setMounted(true), []);

  if (!mounted) return null;

  return (
    <button
      id="theme-toggle-btn"
      onClick={() => setTheme(theme === "dark" ? "light" : "dark")}
      // –î–æ–±–∞–≤–∏–ª–∏ "hidden md:flex" –≤ —Å–∞–º–æ–µ –Ω–∞—á–∞–ª–æ
      className="hidden md:flex fixed bottom-6 right-6 z-50 p-3 lg:p-4 bg-white/90 dark:bg-gray-800/90 backdrop-blur-md shadow-lg border border-gray-200 dark:border-gray-700 rounded-full transition-all duration-300 hover:scale-110 active:scale-95 items-center justify-center text-xl"
      aria-label="–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ç–µ–º—É"
    >
      {theme === "dark" ? "üåô" : "‚òÄÔ∏è"}
    </button>
  );
}
// === –ö–û–ù–ï–¶ –ë–õ–û–ö–ê ===
</file>

<file path="psy-front/components/ui/BookmarkButton.tsx">
// === –ù–ê–ß–ê–õ–û –ë–õ–û–ö–ê: –ö–Ω–æ–ø–∫–∞ –ó–∞–∫–ª–∞–¥–∫–∏ ===
"use client";

import { useBookmarks } from "@/hooks/useBookmarks";
import { triggerHaptic } from "@/lib/haptic";

interface BookmarkButtonProps {
  articleId: string;
  className?: string; // –î–ª—è –∫–∞—Å—Ç–æ–º–Ω—ã—Ö –æ—Ç—Å—Ç—É–ø–æ–≤ –∏–∑–≤–Ω–µ
}

export default function BookmarkButton({ articleId, className = "" }: BookmarkButtonProps) {
  const { isBookmarked, toggleBookmark, mounted } = useBookmarks();

  // –ü–æ–∫–∞ –∫–ª–∏–µ–Ω—Ç –Ω–µ –∑–∞–≥—Ä—É–∑–∏–ª—Å—è, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—É—Å—Ç–æ–π –∫–≤–∞–¥—Ä–∞—Ç, —á—Ç–æ–±—ã –Ω–µ –±—ã–ª–æ –ø—Ä—ã–∂–∫–æ–≤
  if (!mounted) return <div className={`w-10 h-10 ${className}`} />;

  const active = isBookmarked(articleId);

  const handleClick = (e: React.MouseEvent) => {
    e.preventDefault(); // –ï—Å–ª–∏ –∫–Ω–æ–ø–∫–∞ –≤–Ω—É—Ç—Ä–∏ Link, –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ–º –ø–µ—Ä–µ—Ö–æ–¥ –ø–æ —Å—Å—ã–ª–∫–µ
    triggerHaptic(active ? "light" : "medium"); // –í–∏–±—Ä–æ–æ—Ç–∫–ª–∏–∫ (–ø. 26 –¢–ó)
    toggleBookmark(articleId);
  };

  return (
    <button
      id={`bookmark-btn-${articleId}`}
      onClick={handleClick}
      className={`p-2 rounded-full transition-colors duration-300 ${
        active 
          ? "bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400" 
          : "bg-gray-100 dark:bg-zinc-800 text-gray-400 dark:text-zinc-500 hover:text-gray-900 dark:hover:text-white"
      } ${className}`}
      aria-label="–î–æ–±–∞–≤–∏—Ç—å –≤ –∑–∞–∫–ª–∞–¥–∫–∏"
    >
      <svg 
        xmlns="http://www.w3.org/2000/svg" 
        width="20" height="20" 
        viewBox="0 0 24 24" 
        fill={active ? "currentColor" : "none"} 
        stroke="currentColor" 
        strokeWidth="2" 
        strokeLinecap="round" 
        strokeLinejoin="round"
      >
        <path d="m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z"/>
      </svg>
    </button>
  );
}
// === –ö–û–ù–ï–¶ –ë–õ–û–ö–ê ===
</file>

<file path="psy-front/eslint.config.mjs">
import { defineConfig, globalIgnores } from "eslint/config";
import nextVitals from "eslint-config-next/core-web-vitals";
import nextTs from "eslint-config-next/typescript";

const eslintConfig = defineConfig([
  ...nextVitals,
  ...nextTs,
  // Override default ignores of eslint-config-next.
  globalIgnores([
    // Default ignores of eslint-config-next:
    ".next/**",
    "out/**",
    "build/**",
    "next-env.d.ts",
  ]),
]);

export default eslintConfig;
</file>

<file path="psy-front/hooks/useBookmarks.ts">
// === –ù–ê–ß–ê–õ–û –ë–õ–û–ö–ê: –•—É–∫ –ó–∞–∫–ª–∞–¥–æ–∫ (localStorage) ===
"use client";

import { useState, useEffect } from "react";

export function useBookmarks() {
  const [bookmarks, setBookmarks] = useState<string[]>([]);
  const [mounted, setMounted] = useState(false);

  // –ó–∞—â–∏—Ç–∞ –æ—Ç Hydration Mismatch: —á–∏—Ç–∞–µ–º localStorage –¢–û–õ–¨–ö–û –ø–æ—Å–ª–µ –º–∞—É–Ω—Ç–∞ –∫–ª–∏–µ–Ω—Ç–∞
  useEffect(() => {
    setMounted(true);
    try {
      const stored = localStorage.getItem("health_psy_bookmarks");
      if (stored) {
        setBookmarks(JSON.parse(stored));
      }
    } catch (error) {
      console.error("–û—à–∏–±–∫–∞ —á—Ç–µ–Ω–∏—è –∑–∞–∫–ª–∞–¥–æ–∫:", error);
    }
  }, []);

  const toggleBookmark = (id: string) => {
    let updatedBookmarks;
    if (bookmarks.includes(id)) {
      updatedBookmarks = bookmarks.filter((bId) => bId !== id);
    } else {
      updatedBookmarks = [...bookmarks, id];
    }
    
    setBookmarks(updatedBookmarks);
    try {
      localStorage.setItem("health_psy_bookmarks", JSON.stringify(updatedBookmarks));
    } catch (error) {
      console.error("–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∑–∞–∫–ª–∞–¥–æ–∫:", error);
    }
  };

  const isBookmarked = (id: string) => bookmarks.includes(id);

  return { bookmarks, toggleBookmark, isBookmarked, mounted };
}
// === –ö–û–ù–ï–¶ –ë–õ–û–ö–ê ===
</file>

<file path="psy-front/lib/haptic.ts">
// === –ù–ê–ß–ê–õ–û –ë–õ–û–ö–ê: Haptic Feedback Utility ===
export const triggerHaptic = (type: 'light' | 'medium' | 'heavy' = 'light') => {
  // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –∫–æ–¥ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤ –±—Ä–∞—É–∑–µ—Ä–µ –∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤–∏–±—Ä–∞—Ü–∏—é
  if (typeof window === 'undefined' || !navigator.vibrate) return;
  
  const patterns = {
    light: 50, // –õ–µ–≥–∫–∏–π –∫–æ—Ä–æ—Ç–∫–∏–π –∫–ª–∏–∫
    medium: 100, // –ë–æ–ª–µ–µ –æ—â—É—Ç–∏–º—ã–π
    heavy: [50, 50, 50], // –¢—Ä–æ–π–Ω–æ–π –¥–ª—è –æ—à–∏–±–æ–∫/–ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π
  };
  
  navigator.vibrate(patterns[type]);
};
// === –ö–û–ù–ï–¶ –ë–õ–û–ö–ê ===
</file>

<file path="psy-front/middleware.ts">
// middleware.ts
import { NextResponse } from 'next/server';
import type { NextRequest } from 'next/server';

// –°–ø–∏—Å–æ–∫ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã—Ö —è–∑—ã–∫–æ–≤ (—Ç–µ –∂–µ, —á—Ç–æ –º—ã –∑–∞–¥–∞–ª–∏ –≤ Sanity)
const locales = ['ru', 'en', 'ua', 'pl', 'de'];
const defaultLocale = 'ru'; // –Ø–∑—ã–∫ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é

export function middleware(request: NextRequest) {
  const { pathname } = request.nextUrl;

  // 1. –ü—Ä–æ–ø—É—Å–∫–∞–µ–º —Å–∏—Å—Ç–µ–º–Ω—ã–µ —Ñ–∞–π–ª—ã Next.js, –∫–∞—Ä—Ç–∏–Ω–∫–∏ –∏ –∞–¥–º–∏–Ω–∫—É Sanity (!–í–ê–ñ–ù–û!)
  if (
    pathname.startsWith('/_next') ||
    pathname.startsWith('/studio') || // –ó–∞—â–∏—â–∞–µ–º –∞–¥–º–∏–Ω–∫—É
    pathname.startsWith('/api') ||
    pathname.includes('.') // –§–∞–π–ª—ã –≤—Ä–æ–¥–µ favicon.ico –∏–ª–∏ robots.txt
  ) {
    return NextResponse.next();
  }

  // 2. –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —É–∂–µ –ª–æ–∫–∞–ª—å –≤ URL (–Ω–∞–ø—Ä–∏–º–µ—Ä, /en/post/...)
  const pathnameHasLocale = locales.some(
    (locale) => pathname.startsWith(`/${locale}/`) || pathname === `/${locale}`
  );

  // –ï—Å–ª–∏ –ª–æ–∫–∞–ª—å —É–∂–µ –µ—Å—Ç—å, –ø—Ä–æ—Å—Ç–æ –ø—Ä–æ–ø—É—Å–∫–∞–µ–º –¥–∞–ª—å—à–µ
  if (pathnameHasLocale) return NextResponse.next();

  // 3. –ï—Å–ª–∏ –ª–æ–∫–∞–ª–∏ –Ω–µ—Ç (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞—à–µ–ª –Ω–∞ –∫–æ—Ä–µ–Ω—å /), –¥–µ–ª–∞–µ–º —Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ –¥–µ—Ñ–æ–ª—Ç–Ω—É—é (ru)
  request.nextUrl.pathname = `/${defaultLocale}${pathname}`;
  return NextResponse.redirect(request.nextUrl);
}

// –£–∫–∞–∑—ã–≤–∞–µ–º Next.js, –¥–ª—è –∫–∞–∫–∏—Ö –ø—É—Ç–µ–π –∑–∞–ø—É—Å–∫–∞—Ç—å —ç—Ç–æ—Ç middleware
export const config = {
  matcher: [
    // –ü—Ä–∏–º–µ–Ω—è—Ç—å –∫–æ –≤—Å–µ–º –ø—É—Ç—è–º–∏, –∫—Ä–æ–º–µ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö –∏ —Å—Ç–∞—Ç–∏–∫–∏
    '/((?!_next/static|_next/image|favicon.ico).*)',
  ],
};
</file>

<file path="psy-front/postcss.config.mjs">
const config = {
  plugins: {
    "@tailwindcss/postcss": {},
  },
};

export default config;
</file>

<file path="psy-front/public/file.svg">
<svg fill="none" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M14.5 13.5V5.41a1 1 0 0 0-.3-.7L9.8.29A1 1 0 0 0 9.08 0H1.5v13.5A2.5 2.5 0 0 0 4 16h8a2.5 2.5 0 0 0 2.5-2.5m-1.5 0v-7H8v-5H3v12a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1M9.5 5V2.12L12.38 5zM5.13 5h-.62v1.25h2.12V5zm-.62 3h7.12v1.25H4.5zm.62 3h-.62v1.25h7.12V11z" clip-rule="evenodd" fill="#666" fill-rule="evenodd"/></svg>
</file>

<file path="psy-front/public/globe.svg">
<svg fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><g clip-path="url(#a)"><path fill-rule="evenodd" clip-rule="evenodd" d="M10.27 14.1a6.5 6.5 0 0 0 3.67-3.45q-1.24.21-2.7.34-.31 1.83-.97 3.1M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16m.48-1.52a7 7 0 0 1-.96 0H7.5a4 4 0 0 1-.84-1.32q-.38-.89-.63-2.08a40 40 0 0 0 3.92 0q-.25 1.2-.63 2.08a4 4 0 0 1-.84 1.31zm2.94-4.76q1.66-.15 2.95-.43a7 7 0 0 0 0-2.58q-1.3-.27-2.95-.43a18 18 0 0 1 0 3.44m-1.27-3.54a17 17 0 0 1 0 3.64 39 39 0 0 1-4.3 0 17 17 0 0 1 0-3.64 39 39 0 0 1 4.3 0m1.1-1.17q1.45.13 2.69.34a6.5 6.5 0 0 0-3.67-3.44q.65 1.26.98 3.1M8.48 1.5l.01.02q.41.37.84 1.31.38.89.63 2.08a40 40 0 0 0-3.92 0q.25-1.2.63-2.08a4 4 0 0 1 .85-1.32 7 7 0 0 1 .96 0m-2.75.4a6.5 6.5 0 0 0-3.67 3.44 29 29 0 0 1 2.7-.34q.31-1.83.97-3.1M4.58 6.28q-1.66.16-2.95.43a7 7 0 0 0 0 2.58q1.3.27 2.95.43a18 18 0 0 1 0-3.44m.17 4.71q-1.45-.12-2.69-.34a6.5 6.5 0 0 0 3.67 3.44q-.65-1.27-.98-3.1" fill="#666"/></g><defs><clipPath id="a"><path fill="#fff" d="M0 0h16v16H0z"/></clipPath></defs></svg>
</file>

<file path="psy-front/public/next.svg">
<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 394 80"><path fill="#000" d="M262 0h68.5v12.7h-27.2v66.6h-13.6V12.7H262V0ZM149 0v12.7H94v20.4h44.3v12.6H94v21h55v12.6H80.5V0h68.7zm34.3 0h-17.8l63.8 79.4h17.9l-32-39.7 32-39.6h-17.9l-23 28.6-23-28.6zm18.3 56.7-9-11-27.1 33.7h17.8l18.3-22.7z"/><path fill="#000" d="M81 79.3 17 0H0v79.3h13.6V17l50.2 62.3H81Zm252.6-.4c-1 0-1.8-.4-2.5-1s-1.1-1.6-1.1-2.6.3-1.8 1-2.5 1.6-1 2.6-1 1.8.3 2.5 1a3.4 3.4 0 0 1 .6 4.3 3.7 3.7 0 0 1-3 1.8zm23.2-33.5h6v23.3c0 2.1-.4 4-1.3 5.5a9.1 9.1 0 0 1-3.8 3.5c-1.6.8-3.5 1.3-5.7 1.3-2 0-3.7-.4-5.3-1s-2.8-1.8-3.7-3.2c-.9-1.3-1.4-3-1.4-5h6c.1.8.3 1.6.7 2.2s1 1.2 1.6 1.5c.7.4 1.5.5 2.4.5 1 0 1.8-.2 2.4-.6a4 4 0 0 0 1.6-1.8c.3-.8.5-1.8.5-3V45.5zm30.9 9.1a4.4 4.4 0 0 0-2-3.3 7.5 7.5 0 0 0-4.3-1.1c-1.3 0-2.4.2-3.3.5-.9.4-1.6 1-2 1.6a3.5 3.5 0 0 0-.3 4c.3.5.7.9 1.3 1.2l1.8 1 2 .5 3.2.8c1.3.3 2.5.7 3.7 1.2a13 13 0 0 1 3.2 1.8 8.1 8.1 0 0 1 3 6.5c0 2-.5 3.7-1.5 5.1a10 10 0 0 1-4.4 3.5c-1.8.8-4.1 1.2-6.8 1.2-2.6 0-4.9-.4-6.8-1.2-2-.8-3.4-2-4.5-3.5a10 10 0 0 1-1.7-5.6h6a5 5 0 0 0 3.5 4.6c1 .4 2.2.6 3.4.6 1.3 0 2.5-.2 3.5-.6 1-.4 1.8-1 2.4-1.7a4 4 0 0 0 .8-2.4c0-.9-.2-1.6-.7-2.2a11 11 0 0 0-2.1-1.4l-3.2-1-3.8-1c-2.8-.7-5-1.7-6.6-3.2a7.2 7.2 0 0 1-2.4-5.7 8 8 0 0 1 1.7-5 10 10 0 0 1 4.3-3.5c2-.8 4-1.2 6.4-1.2 2.3 0 4.4.4 6.2 1.2 1.8.8 3.2 2 4.3 3.4 1 1.4 1.5 3 1.5 5h-5.8z"/></svg>
</file>

<file path="psy-front/public/vercel.svg">
<svg fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1155 1000"><path d="m577.3 0 577.4 1000H0z" fill="#fff"/></svg>
</file>

<file path="psy-front/public/window.svg">
<svg fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path fill-rule="evenodd" clip-rule="evenodd" d="M1.5 2.5h13v10a1 1 0 0 1-1 1h-11a1 1 0 0 1-1-1zM0 1h16v11.5a2.5 2.5 0 0 1-2.5 2.5h-11A2.5 2.5 0 0 1 0 12.5zm3.75 4.5a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5M7 4.75a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0m1.75.75a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5" fill="#666"/></svg>
</file>

<file path="psy-front/README.md">
This is a [Next.js](https://nextjs.org) project bootstrapped with [`create-next-app`](https://nextjs.org/docs/app/api-reference/cli/create-next-app).

## Getting Started

First, run the development server:

```bash
npm run dev
# or
yarn dev
# or
pnpm dev
# or
bun dev
```

Open [http://localhost:3000](http://localhost:3000) with your browser to see the result.

You can start editing the page by modifying `app/page.tsx`. The page auto-updates as you edit the file.

This project uses [`next/font`](https://nextjs.org/docs/app/building-your-application/optimizing/fonts) to automatically optimize and load [Geist](https://vercel.com/font), a new font family for Vercel.

## Learn More

To learn more about Next.js, take a look at the following resources:

- [Next.js Documentation](https://nextjs.org/docs) - learn about Next.js features and API.
- [Learn Next.js](https://nextjs.org/learn) - an interactive Next.js tutorial.

You can check out [the Next.js GitHub repository](https://github.com/vercel/next.js) - your feedback and contributions are welcome!

## Deploy on Vercel

The easiest way to deploy your Next.js app is to use the [Vercel Platform](https://vercel.com/new?utm_medium=default-template&filter=next.js&utm_source=create-next-app&utm_campaign=create-next-app-readme) from the creators of Next.js.

Check out our [Next.js deployment documentation](https://nextjs.org/docs/app/building-your-application/deploying) for more details.
</file>

<file path="psy-front/tsconfig.json">
{
  "compilerOptions": {
    "target": "ES2017",
    "lib": ["dom", "dom.iterable", "esnext"],
    "allowJs": true,
    "skipLibCheck": true,
    "strict": true,
    "noEmit": true,
    "esModuleInterop": true,
    "module": "esnext",
    "moduleResolution": "bundler",
    "resolveJsonModule": true,
    "isolatedModules": true,
    "jsx": "react-jsx",
    "incremental": true,
    "plugins": [
      {
        "name": "next"
      }
    ],
    "paths": {
      "@/*": ["./*"]
    }
  },
  "include": [
    "next-env.d.ts",
    "**/*.ts",
    "**/*.tsx",
    ".next/types/**/*.ts",
    ".next/dev/types/**/*.ts",
    "**/*.mts"
  ],
  "exclude": ["node_modules"]
}
</file>

<file path="README.md">
# health-psy
</file>

<file path="psy-front/app/[lang]/bookmarks/page.tsx">
// === –ù–ê–ß–ê–õ–û –ë–õ–û–ö–ê: –°—Ç—Ä–∞–Ω–∏—Ü–∞ –ó–∞–∫–ª–∞–¥–æ–∫ ===
"use client";

import { useEffect, useState } from "react";
import { useBookmarks } from "@/hooks/useBookmarks";
import { client } from "@/lib/sanity"
import { bookmarkedArticlesQuery } from "@/lib/queries";
import Link from "next/link";
import BookmarkButton from "@/components/ui/BookmarkButton";

export default function BookmarksPage() {
  const { bookmarks, mounted } = useBookmarks();
  const [articles, setArticles] = useState<any[]>([]);
  const [isLoading, setIsLoading] = useState(true);

  useEffect(() => {
    if (!mounted) return;

    const fetchBookmarks = async () => {
      if (bookmarks.length === 0) {
        setArticles([]);
        setIsLoading(false);
        return;
      }

      try {
        const data = await client.fetch(bookmarkedArticlesQuery, { ids: bookmarks });
        setArticles(data);
      } catch (error) {
        console.error("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∑–∞–∫–ª–∞–¥–æ–∫:", error);
      } finally {
        setIsLoading(false);
      }
    };

    fetchBookmarks();
  }, [bookmarks, mounted]);

  if (!mounted) return null;

  return (
    <main id="bookmarks-page">
      <div className="layout-container">
        <h1 className="text-4xl md:text-5xl font-black text-gray-900 dark:text-zinc-50 tracking-tight mb-8">
          –ó–∞–∫–ª–∞–¥–∫–∏
        </h1>

        {isLoading ? (
          <div className="text-gray-500 animate-pulse font-medium">–ó–∞–≥—Ä—É–∂–∞–µ–º –≤–∞—à–∏ —Å—Ç–∞—Ç—å–∏...</div>
        ) : articles.length === 0 ? (
          <div className="card-editorial py-12 text-center">
            <div className="text-gray-400 dark:text-zinc-500 mb-4">–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö —Å—Ç–∞—Ç–µ–π.</div>
            <Link href="/" className="text-blue-600 font-bold hover:underline">
              –ü–µ—Ä–µ–π—Ç–∏ –∫ —á—Ç–µ–Ω–∏—é
            </Link>
          </div>
        ) : (
          <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
            {articles.map((article) => (
              <Link 
                href={`/post/${article.slug}`} 
                key={article._id}
                className="card-editorial group relative flex flex-col justify-between"
              >
                <div>
                  {article.category && (
                    <span className="text-xs font-bold uppercase tracking-wider text-blue-600 mb-2 block">
                      {article.category}
                    </span>
                  )}
                  <h2 className="text-xl font-extrabold text-gray-900 dark:text-white tracking-tight leading-snug mb-3">
                    {article.title}
                  </h2>
                </div>
                
                <div className="flex items-center justify-between mt-6 pt-4 border-t border-gray-100 dark:border-zinc-800">
                  <span className="text-sm font-medium text-gray-500">{article.readTime || "5 –º–∏–Ω"} —á—Ç–µ–Ω–∏—è</span>
                  <div className="z-10" onClick={(e) => e.preventDefault()}>
                    <BookmarkButton articleId={article._id} />
                  </div>
                </div>
              </Link>
            ))}
          </div>
        )}
      </div>
    </main>
  );
}
// === –ö–û–ù–ï–¶ –ë–õ–û–ö–ê ===
</file>

<file path="psy-front/app/[lang]/search/page.tsx">
// === –ù–ê–ß–ê–õ–û –ë–õ–û–ö–ê: –°—Ç—Ä–∞–Ω–∏—Ü–∞ –ü–æ–∏—Å–∫–∞ (Server + Client) ===
import { client } from "@/lib/sanity"
import { articlesQuery } from "@/lib/queries";
import SearchClient from "@/components/search/SearchClient"; 

export const revalidate = 0; 

export default async function SearchPage() {
  const allArticles = await client.fetch(articlesQuery);

  return (
    <main id="search-page">
      <div className="layout-container">
        <h1 className="text-4xl md:text-5xl font-black text-gray-900 dark:text-zinc-50 tracking-tight mb-8">
          –ü–æ–∏—Å–∫
        </h1>
        
        <div id="search-client" className="space-y-8">
          <div className="relative w-full max-w-2xl mx-auto">
            {/* –¢–≤–æ–π –∫–ª–∏–µ–Ω—Ç—Å–∫–∏–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –ø–æ–∏—Å–∫–∞ */}
          </div>
        </div>
      </div>
    </main>
  );
}
// === –ö–û–ù–ï–¶ –ë–õ–û–ö–ê ===
</file>

<file path="psy-front/app/not-found.tsx">
// === –ù–ê–ß–ê–õ–û –ë–õ–û–ö–ê: –°—Ç—Ä–∞–Ω–∏—Ü–∞ 404 ===
"use client";

import Link from "next/link";
import { usePathname } from "next/navigation";

const notFoundTranslations = {
  ru: {
    message: "–ö–∞–∂–µ—Ç—Å—è, –≤—ã —Å–≤–µ—Ä–Ω—É–ª–∏ –Ω–µ —Ç—É–¥–∞. –ù–æ –≤ –ø—Å–∏—Ö–æ–ª–æ–≥–∏–∏ –Ω–µ—Ç –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –ø—É—Ç–µ–π ‚Äî –µ—Å—Ç—å —Ç–æ–ª—å–∫–æ –Ω–æ–≤—ã–π –æ–ø—ã—Ç.",
    btnText: "–í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ –≥–ª–∞–≤–Ω—É—é"
  },
  en: {
    message: "Looks like you took a wrong turn. But in psychology, there are no wrong paths ‚Äî only new experiences.",
    btnText: "Back to Home"
  },
  ua: {
    message: "–ó–¥–∞—î—Ç—å—Å—è, –≤–∏ –∑–≤–µ—Ä–Ω—É–ª–∏ –Ω–µ —Ç—É–¥–∏. –ê–ª–µ –≤ –ø—Å–∏—Ö–æ–ª–æ–≥—ñ—ó –Ω–µ–º–∞—î –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∏—Ö —à–ª—è—Ö—ñ–≤ ‚Äî —î –ª–∏—à–µ –Ω–æ–≤–∏–π –¥–æ—Å–≤—ñ–¥.",
    btnText: "–ü–æ–≤–µ—Ä–Ω—É—Ç–∏—Å—è –Ω–∞ –≥–æ–ª–æ–≤–Ω—É"
  },
  pl: {
    message: "WyglƒÖda na to, ≈ºe skrƒôci≈Çe≈õ w z≈ÇƒÖ stronƒô. Ale w psychologii nie ma z≈Çych ≈õcie≈ºek ‚Äî sƒÖ tylko nowe do≈õwiadczenia.",
    btnText: "Wr√≥ƒá do strony g≈Ç√≥wnej"
  },
  de: {
    message: "Sieht so aus, als w√§ren Sie falsch abgebogen. Aber in der Psychologie gibt es keine falschen Wege ‚Äî nur neue Erfahrungen.",
    btnText: "Zur√ºck zur Startseite"
  }
};

export default function NotFound() {
  const pathname = usePathname();
  
  // –ò–∑–≤–ª–µ–∫–∞–µ–º –∫–æ–¥ —è–∑—ã–∫–∞ –∏–∑ URL (–Ω–∞–ø—Ä–∏–º–µ—Ä, 'en' –∏–∑ '/en/something')
  const langMatch = pathname?.split('/')[1];
  const isValidLang = ['ru', 'en', 'ua', 'pl', 'de'].includes(langMatch || "");
  const lang = isValidLang ? (langMatch as keyof typeof notFoundTranslations) : "ru";
  
  const t = notFoundTranslations[lang];

  return (
    <main id="global-not-found" className="min-h-screen flex items-center justify-center py-16">
      <div className="layout-container flex flex-col items-center text-center">
        
        <h1 className="text-8xl md:text-9xl font-black text-gray-900 dark:text-white tracking-tight mb-6">
          404
        </h1>
        
        <p className="text-lg md:text-xl text-gray-600 dark:text-gray-400 mb-10 max-w-md leading-relaxed font-medium">
          {t.message}
        </p>
        
        <Link href={`/${lang}`} className="btn-primary">
          {t.btnText}
        </Link>

      </div>
    </main>
  );
}
// === –ö–û–ù–ï–¶ –ë–õ–û–ö–ê ===
</file>

<file path="psy-front/components/article/ArticleActions.tsx">
// === –ù–ê–ß–ê–õ–û –ë–õ–û–ö–ê: Article Actions (Audio & Share) ===
"use client";

import { useState, useEffect } from "react";
import { triggerHaptic } from "@/lib/haptic";

interface ArticleActionsProps {
  title: string;
  textToRead: string;
}

export default function ArticleActions({ title, textToRead }: ArticleActionsProps) {
  const [isPlaying, setIsPlaying] = useState(false);
  const [url, setUrl] = useState("");

  useEffect(() => {
    setUrl(window.location.href);
  }, []);

  const handleShare = async () => {
    triggerHaptic('medium'); 
    
    // 1. –ü–æ–ø—ã—Ç–∫–∞ –Ω–∞—Ç–∏–≤–Ω–æ–≥–æ —à–µ—Ä–∏–Ω–≥–∞ (—Ç—Ä–µ–±—É–µ—Ç HTTPS)
    if (typeof navigator !== "undefined" && navigator.share) {
      try {
        await navigator.share({
          title: title,
          text: "–†–µ–∫–æ–º–µ–Ω–¥—É—é –ø—Ä–æ—á–∏—Ç–∞—Ç—å —ç—Ç—É —Å—Ç–∞—Ç—å—é: " + title,
          url: url,
        });
      } catch (error) {
        console.error("–û—à–∏–±–∫–∞ —à–∞—Ä–∏–Ω–≥–∞:", error);
      }
    } 
    // 2. –§–æ–ª–±—ç–∫ –Ω–∞ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞ (—Ç—Ä–µ–±—É–µ—Ç HTTPS –∏–ª–∏ localhost)
    else if (typeof navigator !== "undefined" && navigator.clipboard && window.isSecureContext) {
      try {
        await navigator.clipboard.writeText(url);
        alert("–°—Å—ã–ª–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞!");
      } catch (error) {
        console.error("–û—à–∏–±–∫–∞ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è:", error);
      }
    } 
    // 3. –§–æ–ª–±—ç–∫ –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ HTTP (IP-–∞–¥—Ä–µ—Å)
    else {
      try {
        // –°–æ–∑–¥–∞–µ–º –Ω–µ–≤–∏–¥–∏–º—ã–π —ç–ª–µ–º–µ–Ω—Ç –¥–ª—è –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è —Ç–µ–∫—Å—Ç–∞ (—Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ HTTPS)
        const textArea = document.createElement("textarea");
        textArea.value = url;
        textArea.style.position = "absolute";
        textArea.style.left = "-999999px";
        document.body.appendChild(textArea);
        textArea.focus();
        textArea.select();
        
        document.execCommand('copy');
        
        textArea.remove();
        alert("–°—Å—ã–ª–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞!");
      } catch (error) {
        console.error("Fallback copy failed", error);
        alert(`–°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å—Å—ã–ª–∫—É –≤—Ä—É—á–Ω—É—é (–Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ):\n\n${url}`);
      }
    }
  };

  const handleAudio = () => {
    triggerHaptic('light');
    
    if (typeof window !== "undefined" && !window.speechSynthesis) {
      alert("–í–∞—à –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∞—É–¥–∏–æ-—á—Ç–µ–Ω–∏–µ.");
      return;
    }

    if (isPlaying) {
      window.speechSynthesis.cancel();
      setIsPlaying(false);
    } else {
      const utterance = new SpeechSynthesisUtterance(textToRead);
      utterance.lang = 'ru-RU';
      utterance.rate = 1.1; 
      utterance.onend = () => setIsPlaying(false);
      window.speechSynthesis.speak(utterance);
      setIsPlaying(true);
    }
  };

  return (
    <div id="article-interactive-actions" className="flex flex-col sm:flex-row items-center gap-4 my-10 border-y border-gray-100 dark:border-zinc-800 py-6">
      <button onClick={handleAudio} className="btn-secondary w-full sm:w-1/2">
        {isPlaying ? "‚èπ –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å" : "üéß –°–ª—É—à–∞—Ç—å —Å—Ç–∞—Ç—å—é"}
      </button>
      <button onClick={handleShare} className="btn-primary w-full sm:w-1/2">
        ‚Üó –ü–æ–¥–µ–ª–∏—Ç—å—Å—è
      </button>
    </div>
  );
}
// === –ö–û–ù–ï–¶ –ë–õ–û–ö–ê ===
</file>

<file path="psy-front/components/feed/SearchAndFeed.tsx">
// === –ù–ê–ß–ê–õ–û –ë–õ–û–ö–ê: Feed with Inline Search ===
"use client";

import { useState, useEffect } from "react";
import Link from "next/link";
import Image from "next/image";
import { Search } from "lucide-react";
import BookmarkButton from "@/components/ui/BookmarkButton";

interface Article {
  _id: string;
  title: string;
  slug: string;
  category: string;
  readTime: number;
  expert: boolean;
  mainImage: string;
}

// 1. –î–û–ë–ê–í–õ–ï–ù lang –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
interface SearchAndFeedProps {
  initialArticles: Article[];
  lang: string; 
}

// 2. –°–ª–æ–≤–∞—Ä–∏ –¥–ª—è –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏–∏ –≤–Ω—É—Ç—Ä–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞
const componentTranslations = {
  ru: {
    placeholder: "–ù–∞–π—Ç–∏ —Å—Ç–∞—Ç—å—é, —Ç–µ–º—É –∏–ª–∏ –∞–≤—Ç–æ—Ä–∞...",
    resultsFor: "–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞",
    latest: "–°–≤–µ–∂–∏–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã",
    notFound: "–ù–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ –ø–æ –∑–∞–ø—Ä–æ—Å—É",
    verified: "–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —ç–∫—Å–ø–µ—Ä—Ç–æ–º",
    categoryDefault: "–ü—Å–∏—Ö–æ–ª–æ–≥–∏—è",
    tags: ["–¢–æ–∫—Å–∏—á–Ω–æ—Å—Ç—å", "–õ–∏—á–Ω—ã–µ –≥—Ä–∞–Ω–∏—Ü—ã", "–¢—Ä–µ–≤–æ–∂–Ω–æ—Å—Ç—å", "–°—Ç—Ä–µ—Å—Å", "–ü—Ä–∏–≤—è–∑–∞–Ω–Ω–æ—Å—Ç—å"]
  },
  en: {
    placeholder: "Search for article, topic or author...",
    resultsFor: "Search results",
    latest: "Latest articles",
    notFound: "Nothing found for",
    verified: "Verified by expert",
    categoryDefault: "Psychology",
    tags: ["Toxicity", "Boundaries", "Anxiety", "Stress", "Attachment"]
  },
  ua: {
    placeholder: "–ó–Ω–∞–π—Ç–∏ —Å—Ç–∞—Ç—Ç—é, —Ç–µ–º—É –∞–±–æ –∞–≤—Ç–æ—Ä–∞...",
    resultsFor: "–†–µ–∑—É–ª—å—Ç–∞—Ç–∏ –ø–æ—à—É–∫—É",
    latest: "–°–≤—ñ–∂—ñ –º–∞—Ç–µ—Ä—ñ–∞–ª–∏",
    notFound: "–ù—ñ—á–æ–≥–æ –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ –∑–∞ –∑–∞–ø–∏—Ç–æ–º",
    verified: "–ü–µ—Ä–µ–≤—ñ—Ä–µ–Ω–æ –µ–∫—Å–ø–µ—Ä—Ç–æ–º",
    categoryDefault: "–ü—Å–∏—Ö–æ–ª–æ–≥—ñ—è",
    tags: ["–¢–æ–∫—Å–∏—á–Ω—ñ—Å—Ç—å", "–û—Å–æ–±–∏—Å—Ç—ñ –∫–æ—Ä–¥–æ–Ω–∏", "–¢—Ä–∏–≤–æ–∂–Ω—ñ—Å—Ç—å", "–°—Ç—Ä–µ—Å", "–ü—Ä–∏—Ö–∏–ª—å–Ω—ñ—Å—Ç—å"]
  },
  pl: {
    placeholder: "Szukaj artyku≈Çu, tematu lub autora...",
    resultsFor: "Wyniki wyszukiwania",
    latest: "Najnowsze artyku≈Çy",
    notFound: "Nic nie znaleziono dla",
    verified: "Sprawdzone przez eksperta",
    categoryDefault: "Psychologia",
    tags: ["Toksyczno≈õƒá", "Granice", "Lƒôk", "Stres", "PrzywiƒÖzanie"]
  },
  de: {
    placeholder: "Artikel, Thema oder Autor suchen...",
    resultsFor: "Suchergebnisse",
    latest: "Neueste Artikel",
    notFound: "Nichts gefunden f√ºr",
    verified: "Von Experten gepr√ºft",
    categoryDefault: "Psychologie",
    tags: ["Toxizit√§t", "Grenzen", "Angst", "Stress", "Bindung"]
  }
};

// 3. –î–û–ë–ê–í–õ–ï–ù lang –≤ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞
export default function SearchAndFeed({ initialArticles, lang }: SearchAndFeedProps) {
  const [query, setQuery] = useState("");
  const [debouncedQuery, setDebouncedQuery] = useState("");
  const [results, setResults] = useState<Article[]>(initialArticles);

  // –ü–æ–ª—É—á–∞–µ–º –Ω—É–∂–Ω—ã–µ –ø–µ—Ä–µ–≤–æ–¥—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø—Ä–æ–ø—Å–∞ lang
  const t = componentTranslations[lang as keyof typeof componentTranslations] || componentTranslations.ru;
  const currentTags = t.tags;

  // –î–µ–±–∞—É–Ω—Å (–∑–∞–¥–µ—Ä–∂–∫–∞ –≤–≤–æ–¥–∞)
  useEffect(() => {
    const timer = setTimeout(() => {
      setDebouncedQuery(query);
    }, 300);
    return () => clearTimeout(timer);
  }, [query]);

  // –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Å—Ç–∞—Ç–µ–π
  useEffect(() => {
    if (!debouncedQuery.trim()) {
      setResults(initialArticles);
      return;
    }
    
    const lowerQuery = debouncedQuery.toLowerCase();
    const filtered = initialArticles.filter((article) => 
      article.title.toLowerCase().includes(lowerQuery) || 
      (article.category && article.category.toLowerCase().includes(lowerQuery))
    );
    
    setResults(filtered);
  }, [debouncedQuery, initialArticles]);

  return (
    <div className="space-y-10">
      
      {/* 1. –ë–ª–æ–∫ –ü–æ–∏—Å–∫–∞ –∏ –¢–µ–≥–æ–≤ */}
      <section id="search-section" className="space-y-6">
        <div className="relative w-full">
          <div className="absolute inset-y-0 left-0 flex items-center pl-7 pointer-events-none text-gray-400">
            <Search size={20} />
          </div>
          <input
            type="text"
            value={query}
            onChange={(e) => setQuery(e.target.value)}
            placeholder={t.placeholder}
            className="w-full py-4 pl-14 pr-7 text-lg bg-gray-50 dark:bg-zinc-900 border border-gray-200 dark:border-zinc-800 text-gray-900 dark:text-white rounded-full focus:outline-none focus:ring-2 focus:ring-blue-500 shadow-sm transition-all"
          />
        </div>

        {/* –¢–µ–≥–∏ */}
        <div id="tags-carousel" className="flex gap-3 overflow-x-auto pb-4 custom-scrollbar snap-x snap-mandatory scroll-smooth">
          {currentTags.map((tag) => (
            <button 
              key={tag} 
              onClick={() => setQuery(tag)} 
              className={`tag-pill whitespace-nowrap snap-center cursor-pointer transition-colors ${
                query.toLowerCase() === tag.toLowerCase() 
                  ? 'bg-blue-600 text-white border-blue-600 dark:bg-blue-600 dark:text-white' 
                  : ''
              }`}
            >
              #{tag}
            </button>
          ))}
        </div>
      </section>

      {/* 2. –õ–µ–Ω—Ç–∞ –°—Ç–∞—Ç–µ–π (–†–µ–∑—É–ª—å—Ç–∞—Ç—ã) */}
      <section id="latest-articles" className="space-y-8">
        <h2 className="text-2xl font-extrabold text-gray-900 dark:text-zinc-50">
          {query ? `${t.resultsFor} (${results.length})` : t.latest}
        </h2>

        {results.length === 0 ? (
          <div className="text-center py-10 text-gray-500 dark:text-zinc-500 font-medium">
            {t.notFound} ¬´{query}¬ª
          </div>
        ) : (
          <div id="articles-grid" className="grid grid-cols-1 md:grid-cols-2 gap-6">
            {results.map((article, index) => (
              <Link key={article._id} href={`/post/${article.slug}`} className="group block outline-none">
                <article className="card-editorial h-full flex flex-col hover:border-blue-500/30 transition-all border border-transparent relative">
                  
                  <div className="relative w-full h-48 rounded-2xl bg-gray-100 dark:bg-zinc-800 mb-5 overflow-hidden">
                    {article.mainImage ? (
                      <Image 
                        src={article.mainImage} 
                        alt={article.title}
                        fill
                        sizes="(max-width: 768px) 100vw, 50vw"
                        priority={index === 0 && !query}
                        className="object-cover group-hover:scale-105 transition-transform duration-500" 
                      />
                    ) : (
                      <div className="absolute inset-0 bg-gradient-to-tr from-blue-100 to-zinc-200 dark:from-zinc-800 dark:to-zinc-700" />
                    )}
                  </div>

                  <div className="flex items-center justify-between mb-3">
                    <div className="flex items-center gap-3 text-xs font-bold uppercase tracking-wider">
                      <span className="text-blue-600 dark:text-blue-400">{article.category || t.categoryDefault}</span>
                      <span className="text-gray-400 dark:text-zinc-600">‚Ä¢</span>
                      <span className="text-gray-500">{article.readTime || 5} –º–∏–Ω</span>
                    </div>
                    
                    <div className="z-10 relative" onClick={(e) => e.preventDefault()}>
                       <BookmarkButton articleId={article._id} />
                    </div>
                  </div>

                  <h3 className="text-xl font-extrabold text-gray-900 dark:text-white leading-snug mb-4 group-hover:text-blue-600 transition-colors">
                    {article.title}
                  </h3>

                  {article.expert && (
                    <div className="mt-auto pt-4 border-t border-gray-100 dark:border-zinc-800 flex items-center gap-2">
                       <span className="text-sm font-bold text-gray-600 dark:text-zinc-400">‚úì {t.verified}</span>
                    </div>
                  )}
                </article>
              </Link>
            ))}
          </div>
        )}
      </section>

    </div>
  );
}
// === –ö–û–ù–ï–¶ –ë–õ–û–ö–ê ===
</file>

<file path="psy-front/components/search/SearchClient.tsx">
// === –ù–ê–ß–ê–õ–û –ë–õ–û–ö–ê: –ö–ª–∏–µ–Ω—Ç—Å–∫–∏–π –ü–æ–∏—Å–∫ (Algolia) ===
"use client";

import { liteClient } from "algoliasearch/lite";
import { InstantSearch, useSearchBox, useHits, Configure } from "react-instantsearch";
import { Search } from "lucide-react";
import Link from "next/link";
import BookmarkButton from "@/components/ui/BookmarkButton";

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç–∞ Algolia (–∏—Å–ø–æ–ª—å–∑—É–µ–º liteClient –¥–ª—è v5)
// –ï—Å–ª–∏ –∫–ª—é—á–µ–π –Ω–µ—Ç –≤ .env, –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ–º –ø–∞–¥–µ–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
const searchClient = liteClient(
  process.env.NEXT_PUBLIC_ALGOLIA_APP_ID || "APP_ID_MISSING",
  process.env.NEXT_PUBLIC_ALGOLIA_SEARCH_API_KEY || "API_KEY_MISSING"
);

// –ö–∞—Å—Ç–æ–º–Ω–æ–µ –ø–æ–ª–µ –≤–≤–æ–¥–∞ (SearchBox), —Å—Ç–∏–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –ø–æ–¥ –Ω–∞—à –¥–∏–∑–∞–π–Ω
function CustomSearchBox() {
  const { query, refine } = useSearchBox();

  return (
    <div className="relative w-full max-w-2xl mx-auto">
      <div className="absolute inset-y-0 left-0 flex items-center pl-7 pointer-events-none text-gray-400">
        <Search size={20} />
      </div>
      <input
        type="text"
        value={query}
        onChange={(e) => refine(e.target.value)}
        placeholder="–ù–∞–π—Ç–∏ —Å—Ç–∞—Ç—å—é, —Ç–µ–º—É –∏–ª–∏ –∞–≤—Ç–æ—Ä–∞..."
        className="w-full py-4 pl-14 pr-7 text-lg bg-gray-50 dark:bg-zinc-900 border border-gray-200 dark:border-zinc-800 text-gray-900 dark:text-white rounded-full focus:outline-none focus:ring-2 focus:ring-blue-500 shadow-sm transition-all"
      />
    </div>
  );
}

// –ö–∞—Å—Ç–æ–º–Ω—ã–π –≤—ã–≤–æ–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ (Hits)
function CustomHits() {
  const { hits } = useHits();

  if (hits.length === 0) {
    return (
      <div className="text-center py-10 text-gray-500 dark:text-zinc-500 font-medium">
        –ù–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –¥—Ä—É–≥–æ–π –∑–∞–ø—Ä–æ—Å.
      </div>
    );
  }

  return (
    <div className="grid grid-cols-1 md:grid-cols-2 gap-4 mt-6">
      {hits.map((article: any) => (
        <Link
          href={`/post/${article.slug?.current || article.slug}`}
          key={article.objectID || article._id}
          className="flex flex-col justify-between p-5 bg-white dark:bg-[#0a0a0a] border border-gray-100 dark:border-zinc-800 rounded-2xl hover:border-gray-200 dark:hover:border-zinc-700 transition-colors"
        >
          <div>
            <h3 className="text-lg font-bold text-gray-900 dark:text-white tracking-tight mb-2">
              {article.title}
            </h3>
          </div>
          <div className="flex justify-between items-center mt-4">
            <span className="text-xs font-bold text-blue-600 uppercase tracking-wide">
              {article.category || "–°—Ç–∞—Ç—å—è"}
            </span>
            <div className="z-10" onClick={(e) => e.preventDefault()}>
              <BookmarkButton articleId={article.objectID || article._id} />
            </div>
          </div>
        </Link>
      ))}
    </div>
  );
}

interface SearchClientProps {
  initialArticles: any[]; // –û—Å—Ç–∞–≤–ª—è–µ–º –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏, –Ω–æ —Ç–µ–ø–µ—Ä—å –¥–∞–Ω–Ω—ã–µ —Ç—è–Ω–µ—Ç Algolia
}

export default function SearchClient({ initialArticles }: SearchClientProps) {
  // –ò–º—è –∏–Ω–¥–µ–∫—Å–∞ Algolia (—Å–æ–∑–¥–∞–π –µ–≥–æ –≤ –ø–∞–Ω–µ–ª–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è Algolia)
  const indexName = "posts_index"; 

  return (
    <div id="search-client-algolia" className="space-y-8">
      <InstantSearch searchClient={searchClient} indexName={indexName}>
        {/* –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–∏—Å–∫–∞ (–∏—Å–∫–∞—Ç—å —Ç–æ–ª—å–∫–æ –ø–æ —ç—Ç–∏–º –ø–æ–ª—è–º) */}
        <Configure hitsPerPage={10} />
        
        <CustomSearchBox />
        
        <div>
          <h2 className="text-sm font-bold text-gray-400 uppercase tracking-wider mb-4 pl-2">
            –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞
          </h2>
          <CustomHits />
        </div>
      </InstantSearch>
    </div>
  );
}
// === –ö–û–ù–ï–¶ –ë–õ–û–ö–ê ===
</file>

<file path="psy-front/components/ui/ProgressBar.tsx">
// === –ù–ê–ß–ê–õ–û –ë–õ–û–ö–ê: Reading Progress Bar ===
"use client";

import { useEffect, useState } from "react";

export default function ProgressBar() {
  const [readingProgress, setReadingProgress] = useState(0);

  useEffect(() => {
    const updateScroll = () => {
      const currentScrollY = window.scrollY;
      const scrollHeight = document.body.scrollHeight - window.innerHeight;
      
      if (scrollHeight) {
        setReadingProgress(Number((currentScrollY / scrollHeight).toFixed(2)) * 100);
      }
    };

    window.addEventListener("scroll", updateScroll, { passive: true });
    
    return () => window.removeEventListener("scroll", updateScroll);
  }, []);

  return (
    <div id="progress-bar-container" className="fixed top-0 left-0 w-full h-1.5 bg-gray-200 dark:bg-zinc-800 z-50 pointer-events-none">
      <div
        id="progress-bar-fill"
        className="h-full bg-blue-600 dark:bg-blue-500 transition-all duration-150 ease-out"
        style={{ width: `${readingProgress}%` }}
      />
    </div>
  );
}
// === –ö–û–ù–ï–¶ –ë–õ–û–ö–ê ===
</file>

<file path="psy-front/components/ui/ThemeToggle.tsx">
// === –ù–ê–ß–ê–õ–û –ë–õ–û–ö–ê: Header Theme Toggle ===
"use client";

import { useTheme } from "next-themes";
import { useEffect, useState } from "react";

export function ThemeToggle() {
  const { theme, setTheme, systemTheme } = useTheme();
  const [mounted, setMounted] = useState(false);

  useEffect(() => {
    setMounted(true);
  }, []);

  if (!mounted) {
    return <div className="w-9 h-9 bg-gray-200 dark:bg-zinc-800 rounded-xl animate-pulse" />;
  }

  // –£—á–∏—Ç—ã–≤–∞–µ–º —Å–∏—Å—Ç–µ–º–Ω—É—é —Ç–µ–º—É
  const currentTheme = theme === "system" ? systemTheme : theme;

  return (
    <button
      onClick={() => setTheme(currentTheme === "dark" ? "light" : "dark")}
      className="p-2 rounded-xl bg-gray-100 dark:bg-zinc-800 text-gray-900 dark:text-white hover:bg-gray-200 dark:hover:bg-zinc-700 transition-colors flex items-center justify-center"
      aria-label="–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ç–µ–º—É"
    >
      {currentTheme === "dark" ? (
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
          <circle cx="12" cy="12" r="4"/>
          <path d="M12 2v2"/><path d="M12 20v2"/><path d="m4.93 4.93 1.41 1.41"/><path d="m17.66 17.66 1.41 1.41"/><path d="M2 12h2"/><path d="M20 12h2"/><path d="m6.34 17.66-1.41 1.41"/><path d="m19.07 4.93-1.41 1.41"/>
        </svg>
      ) : (
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
          <path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"/>
        </svg>
      )}
    </button>
  );
}
// === –ö–û–ù–ï–¶ –ë–õ–û–ö–ê ===
</file>

<file path="psy-front/next.config.ts">
// === –ù–ê–ß–ê–õ–û –ë–õ–û–ö–ê: Next Config ===
import type { NextConfig } from "next";

const nextConfig: NextConfig = {
  images: {
    remotePatterns: [
      {
        protocol: "https",
        hostname: "cdn.sanity.io", // –†–∞–∑—Ä–µ—à–∞–µ–º –∫–∞—Ä—Ç–∏–Ω–∫–∏ –∏–∑ Sanity
      },
    ],
  },
};

export default nextConfig;
// === –ö–û–ù–ï–¶ –ë–õ–û–ö–ê ===
</file>

<file path="psy-admin/package.json">
{
  "name": "psy-admin",
  "private": true,
  "version": "1.0.0",
  "main": "package.json",
  "license": "UNLICENSED",
  "scripts": {
    "dev": "sanity dev",
    "start": "sanity start",
    "build": "sanity build",
    "deploy": "sanity deploy",
    "deploy-graphql": "sanity graphql deploy"
  },
  "keywords": [
    "sanity"
  ],
  "dependencies": {
    "@sanity/cli": "^5.10.0",
    "@sanity/document-internationalization": "^5.0.1",
    "@sanity/vision": "^5.10.0",
    "next-themes": "^0.4.6",
    "react": "^19.1",
    "react-dom": "^19.1",
    "sanity": "^5.10.0",
    "styled-components": "^6.1.18"
  },
  "devDependencies": {
    "@sanity/eslint-config-studio": "^6.0.0",
    "@types/react": "^19.1",
    "eslint": "^9.28",
    "prettier": "^3.5",
    "typescript": "^5.8"
  },
  "prettier": {
    "semi": false,
    "printWidth": 100,
    "bracketSpacing": false,
    "singleQuote": true
  }
}
</file>

<file path="psy-admin/sanity.cli.ts">
// === –ù–ê–ß–ê–õ–û –ë–õ–û–ö–ê: Sanity CLI Config ===
import {defineCliConfig} from 'sanity/cli'

export default defineCliConfig({
  api: {
    projectId: 'dp2yjc73', // üëà –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π Project ID
    dataset: 'production'
  },
  deployment: {
    appId: 'njvezevwrat8kpk3ahprsimp', // –û—Å—Ç–∞–≤–ª—è–µ–º —Ç–æ—Ç, —á—Ç–æ –≤—ã–¥–∞–ª —Ç–µ—Ä–º–∏–Ω–∞–ª
  }
})
// === –ö–û–ù–ï–¶ –ë–õ–û–ö–ê ===
</file>

<file path="psy-admin/sanity.config.ts">
// === –ù–ê–ß–ê–õ–û –ë–õ–û–ö–ê: Sanity Config Admin ===
import {defineConfig} from 'sanity'
import {structureTool} from 'sanity/structure'
import {visionTool} from '@sanity/vision'
import {schemaTypes} from './schemaTypes'
import {documentInternationalization} from '@sanity/document-internationalization'

export default defineConfig({
  name: 'default',
  title: 'Health Psy CMS',
  // === –ù–ê–ß–ê–õ–û –ë–õ–û–ö–ê: Sanity Config Admin ===
  projectId: process.env.SANITY_STUDIO_PROJECT_ID || 'dp2yjc73', // üëà –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π Project ID
  dataset: process.env.SANITY_STUDIO_DATASET || 'production',
  // === –ö–û–ù–ï–¶ –ë–õ–û–ö–ê ===

  plugins: [
    structureTool(),
    visionTool(),
    // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –ø–ª–∞–≥–∏–Ω –ø–µ—Ä–µ–≤–æ–¥–æ–≤!
    documentInternationalization({
      supportedLanguages: [
        {id: 'ru', title: '–†—É—Å—Å–∫–∏–π'},
        {id: 'en', title: 'English'},
        {id: 'ua', title: '–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞'},
        {id: 'pl', title: 'Polski'},
        {id: 'de', title: 'Deutsch'}
      ],
      schemaTypes: ['post'],
      languageField: 'language',
    })
  ],

  schema: {
    types: schemaTypes,
  },
})
// === –ö–û–ù–ï–¶ –ë–õ–û–ö–ê ===
</file>

<file path="psy-front/app/[lang]/post/[slug]/page.tsx">
// === –ù–ê–ß–ê–õ–û –ë–õ–û–ö–ê: Single Post Page ===
import { client } from "@/lib/sanity";
import { groq } from "next-sanity";
import { PortableText } from "@portabletext/react";
import Link from "next/link";
import Image from "next/image"; 
import ProgressBar from "@/components/ui/ProgressBar"; 
import ArticleActions from "@/components/article/ArticleActions"; 
import BookmarkButton from "@/components/ui/BookmarkButton";
import { Metadata } from "next";
import TranslationProvider from "./TranslationProvider"; // –ú–´ –°–û–ó–î–ê–î–ò–ú –≠–¢–û–¢ –§–ê–ô–õ –°–õ–ï–î–£–Æ–©–ò–ú –®–ê–ì–û–ú

// –°–ª–æ–≤–∞—Ä–∏ –¥–ª—è –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã "–ù–µ –Ω–∞–π–¥–µ–Ω–æ" –∏ —Ñ—É—Ç–µ—Ä–∞ —Å—Ç–∞—Ç—å–∏
const postTranslations = {
  ru: { 
    notFoundTitle: "–°—Ç–∞—Ç—å—è –Ω–µ –Ω–∞–π–¥–µ–Ω–∞", 
    backHome: "–í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ –≥–ª–∞–≤–Ω—É—é", 
    backBtn: "‚Üê –ù–∞–∑–∞–¥ –∫ —Å—Ç–∞—Ç—å—è–º",
    categoryDefault: "–ü—Å–∏—Ö–æ–ª–æ–≥–∏—è",
    minRead: "–º–∏–Ω —á—Ç–µ–Ω–∏—è",
    verified: "–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —ç–∫—Å–ø–µ—Ä—Ç–æ–º",
    footerTitle: "–ü–æ–Ω—Ä–∞–≤–∏–ª—Å—è –º–∞—Ç–µ—Ä–∏–∞–ª?",
    footerText: "–ü–æ–¥–ø–∏—à–∏—Ç–µ—Å—å –Ω–∞ –Ω–∞—à–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è, —á—Ç–æ–±—ã –Ω–µ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å –Ω–æ–≤—ã–µ —Å–æ–≤–µ—Ç—ã —ç–∫—Å–ø–µ—Ä—Ç–æ–≤."
  },
  en: { 
    notFoundTitle: "Article not found", 
    backHome: "Back to home", 
    backBtn: "‚Üê Back to articles",
    categoryDefault: "Psychology",
    minRead: "min read",
    verified: "Verified by expert",
    footerTitle: "Did you like this article?",
    footerText: "Subscribe to our updates so you don't miss new expert advice."
  },
  ua: { 
    notFoundTitle: "–°—Ç–∞—Ç—Ç—é –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ", 
    backHome: "–ü–æ–≤–µ—Ä–Ω—É—Ç–∏—Å—è –Ω–∞ –≥–æ–ª–æ–≤–Ω—É", 
    backBtn: "‚Üê –ù–∞–∑–∞–¥ –¥–æ —Å—Ç–∞—Ç–µ–π",
    categoryDefault: "–ü—Å–∏—Ö–æ–ª–æ–≥—ñ—è",
    minRead: "—Ö–≤ —á–∏—Ç–∞–Ω–Ω—è",
    verified: "–ü–µ—Ä–µ–≤—ñ—Ä–µ–Ω–æ –µ–∫—Å–ø–µ—Ä—Ç–æ–º",
    footerTitle: "–°–ø–æ–¥–æ–±–∞–≤—Å—è –º–∞—Ç–µ—Ä—ñ–∞–ª?",
    footerText: "–ü—ñ–¥–ø–∏—à—ñ—Ç—å—Å—è –Ω–∞ –Ω–∞—à—ñ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è, —â–æ–± –Ω–µ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç–∏ –Ω–æ–≤—ñ –ø–æ—Ä–∞–¥–∏ –µ–∫—Å–ø–µ—Ä—Ç—ñ–≤."
  },
  pl: { 
    notFoundTitle: "Nie znaleziono artyku≈Çu", 
    backHome: "Wr√≥ƒá do strony g≈Ç√≥wnej", 
    backBtn: "‚Üê Wr√≥ƒá do artyku≈Ç√≥w",
    categoryDefault: "Psychologia",
    minRead: "min czytania",
    verified: "Sprawdzone przez eksperta",
    footerTitle: "Podoba≈Ç Ci siƒô materia≈Ç?",
    footerText: "Zapisz siƒô na nasze aktualizacje, aby nie przegapiƒá nowych porad ekspert√≥w."
  },
  de: { 
    notFoundTitle: "Artikel nicht gefunden", 
    backHome: "Zur√ºck zur Startseite", 
    backBtn: "‚Üê Zur√ºck zu den Artikeln",
    categoryDefault: "Psychologie",
    minRead: "Minuten Lesezeit",
    verified: "Von Experten gepr√ºft",
    footerTitle: "Hat Ihnen der Artikel gefallen?",
    footerText: "Abonnieren Sie unsere Updates, um keine neuen Experten-Tipps zu verpassen."
  },
};

// 1. –ó–ê–ü–†–û–° –ò–ó–ú–ï–ù–ï–ù: –¢–µ–ø–µ—Ä—å –º—ã –ø–æ–ª—É—á–∞–µ–º –µ—â–µ translationId –∏ slugs –≤—Å–µ—Ö –ø–µ—Ä–µ–≤–æ–¥–æ–≤
const postQuery = groq`*[_type == "post" && slug.current == $slug && language == $lang][0] {
  _id,
  title,
  body,
  publishedAt,
  category,
  readTime,
  expert,
  translationId,
  "mainImage": mainImage.asset->url,
  "plainText": pt::text(body),
  "translations": *[_type == "post" && translationId == ^.translationId] {
    language,
    "slug": slug.current
  }
}`;

export async function generateMetadata({ params }: { params: Promise<{ lang: string; slug: string }> }): Promise<Metadata> {
  const { lang, slug } = await params;
  const post = await client.fetch(postQuery, { lang, slug });

  const t = postTranslations[lang as keyof typeof postTranslations] || postTranslations.ru;

  if (!post) return { title: t.notFoundTitle };

  return {
    title: `${post.title} | HealthPsy`,
    description: post.plainText?.substring(0, 160) + "...",
    openGraph: {
      title: post.title,
      description: post.plainText?.substring(0, 160) + "...",
      images: post.mainImage ? [post.mainImage] : [],
      type: "article",
      publishedTime: post.publishedAt,
      authors: post.expert ? [post.expert] : [],
    },
  };
}

const portableTextComponents = {
  types: {
    youtube: ({ value }: any) => {
      const { url } = value;
      if (!url) return null;

      const isShorts = url.includes("shorts/");
      const videoId = isShorts 
        ? url.split("shorts/")[1].split(/[?#]/)[0] 
        : url.split("v=")[1]?.split("&")[0];

      return (
        <div id={`video-${videoId}`} className="my-10 flex justify-center">
          <div className={`w-full overflow-hidden rounded-3xl shadow-2xl bg-black ${
            isShorts ? "max-w-[315px] aspect-[9/16]" : "aspect-video"
          }`}>
            <iframe
              width="100%"
              height="100%"
              src={`https://www.youtube.com/embed/${videoId}`}
              title="YouTube video player"
              frameBorder="0"
              allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
              allowFullScreen
              className="w-full h-full"
            ></iframe>
          </div>
        </div>
      );
    },
  },
};

interface PostPageProps {
  params: Promise<{ lang: string; slug: string }>;
}

export default async function PostPage({ params }: PostPageProps) {
  const { lang, slug } = await params;
  const t = postTranslations[lang as keyof typeof postTranslations] || postTranslations.ru;
  const post = await client.fetch(postQuery, { lang, slug });

  if (!post) {
    return (
      <main id="post-not-found" className="flex items-center justify-center min-h-[50vh]">
        <div className="text-center">
          <h1 className="text-2xl font-bold mb-4 font-sans">{t.notFoundTitle}</h1>
          <Link href={`/${lang}`} className="text-blue-600 hover:underline">{t.backHome}</Link>
        </div>
      </main>
    );
  }

  const textForAudio = post.plainText || post.title;

  const jsonLd = {
    "@context": "https://schema.org",
    "@type": "Article",
    headline: post.title,
    image: post.mainImage ? [post.mainImage] : [],
    datePublished: post.publishedAt,
    author: {
      "@type": "Person",
      name: post.expert || "–†–µ–¥–∞–∫—Ü–∏—è",
    },
    timeRequired: `PT${post.readTime || 5}M`,
  };

  // –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º –ø–µ—Ä–µ–≤–æ–¥—ã –≤ —É–¥–æ–±–Ω—ã–π –æ–±—ä–µ–∫—Ç: { en: "how-to-stop", ru: "kak-perestat" }
  const translationMap = post.translations?.reduce((acc: any, curr: any) => {
    if (curr.language && curr.slug) {
      acc[curr.language] = curr.slug;
    }
    return acc;
  }, {}) || {};

  return (
    <>
      <script
        type="application/ld+json"
        dangerouslySetInnerHTML={{ __html: JSON.stringify(jsonLd) }}
      />
      
      <ProgressBar />
      
      {/* 2. –î–û–ë–ê–í–õ–ï–ù –ü–†–û–í–ê–ô–î–ï–† –ü–ï–†–ï–í–û–î–û–í */}
      <TranslationProvider translations={translationMap} currentLang={lang} />
      
      <main id="post-main-content" className="font-sans">
        <article id="post-article" className="layout-container max-w-3xl mx-auto">
          
          <nav id="post-navigation" className="mb-8">
            <Link
              href={`/${lang}`}
              className="text-sm font-bold text-zinc-500 hover:text-blue-600 transition-colors flex items-center gap-2"
            >
              {t.backBtn}
            </Link>
          </nav>

          <header id="post-header">
            <h1 id="post-title" className="text-3xl md:text-5xl font-black text-gray-900 dark:text-zinc-50 mb-6 leading-tight">
              {post.title}
            </h1>

            <div className="flex items-center justify-between mb-10">
              <div id="post-meta" className="flex flex-wrap items-center gap-4 text-sm font-medium">
                <span className="bg-blue-100 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400 px-3 py-1 rounded-full text-[10px] font-black uppercase tracking-widest">
                  {post.category || t.categoryDefault}
                </span>
                <span className="text-gray-400 dark:text-zinc-500">
                  {post.readTime || 5} {t.minRead}
                </span>
                <time className="text-gray-400 dark:text-zinc-500 hidden sm:inline-block">
                  {new Date(post.publishedAt).toLocaleDateString(lang === "en" ? "en-US" : "ru-RU")}
                </time>
                {post.expert && (
                  <span className="text-green-600 dark:text-green-400 font-bold flex items-center gap-1">
                    ‚úì <span className="hidden sm:inline-block">{t.verified}</span>
                  </span>
                )}
              </div>

              <div className="shrink-0 pl-4">
                <BookmarkButton articleId={post._id} />
              </div>
            </div>
          </header>

          {post.mainImage && (
            <div id="post-hero-image" className="relative w-full aspect-video rounded-3xl overflow-hidden mb-12 shadow-2xl">
              <Image 
                src={post.mainImage} 
                alt={post.title} 
                fill
                priority
                sizes="(max-width: 768px) 100vw, 768px"
                className="object-cover w-full h-full"
              />
            </div>
          )}

          <ArticleActions title={post.title} textToRead={textForAudio} />

          <div id="post-body" className="prose prose-zinc dark:prose-invert max-w-none 
            prose-lg 
            prose-p:text-gray-700 dark:prose-p:text-zinc-200 
            prose-p:leading-relaxed 
            prose-headings:font-black 
            prose-a:text-blue-600 dark:prose-a:text-blue-400">
            
            <PortableText 
              value={post.body} 
              components={portableTextComponents} 
            />
            
          </div>

          <footer id="post-footer" className="p-8 bg-gray-50 dark:bg-zinc-900 rounded-3xl border border-gray-200 dark:border-zinc-800 mt-16 text-center">
             <h3 className="text-lg font-bold mb-2">{t.footerTitle}</h3>
             <p className="text-gray-500 dark:text-zinc-400 text-sm">
               {t.footerText}
             </p>
          </footer>

        </article>
      </main>
    </>
  );
}
// === –ö–û–ù–ï–¶ –ë–õ–û–ö–ê ===
</file>

<file path="psy-front/components/LanguageSwitcher.tsx">
// === –ù–ê–ß–ê–õ–û –ë–õ–û–ö–ê: LanguageSwitcher ===
"use client";

import { usePathname, useRouter } from "next/navigation";

export default function LanguageSwitcher() {
  const pathname = usePathname();
  const router = useRouter();

  const languages = [
    { code: "ru", label: "RU" },
    { code: "en", label: "EN" },
    { code: "ua", label: "UA" },
    { code: "pl", label: "PL" },
    { code: "de", label: "DE" },
  ];

  const handleLanguageChange = (locale: string) => {
    if (!pathname) {
      router.push(`/${locale}`);
      return;
    }

    const segments = pathname.split("/");
    
    // –ë–ï–ó–û–ü–ê–°–ù–´–ô –ü–ï–†–ï–•–û–î: –ï—Å–ª–∏ –º—ã –≤–Ω—É—Ç—Ä–∏ —Å—Ç–∞—Ç—å–∏, –ø—Ä–∏ —Å–º–µ–Ω–µ —è–∑—ã–∫–∞
    // –º—ã –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∞ –≥–ª–∞–≤–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É –Ω–æ–≤–æ–≥–æ —è–∑—ã–∫–∞, 
    // —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –æ—à–∏–±–∫–∏ 404 (—Ç.–∫. —Å–ª–∞–≥–∏ —Å—Ç–∞—Ç–µ–π –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —è–∑—ã–∫–∞—Ö –æ—Ç–ª–∏—á–∞—é—Ç—Å—è)
    if (segments.includes("post")) {
      router.push(`/${locale}`);
      router.refresh();
      return;
    }

    // –î–ª—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö —Å—Ç—Ä–∞–Ω–∏—Ü (–≥–ª–∞–≤–Ω–∞—è, –∑–∞–∫–ª–∞–¥–∫–∏) –ø—Ä–æ—Å—Ç–æ –º–µ–Ω—è–µ–º –∫–æ–¥ —è–∑—ã–∫–∞
    segments[1] = locale;
    router.push(segments.join("/"));
    router.refresh();
  };

  return (
    <div 
      id="desktop-lang-switcher" 
      className="hidden md:flex items-center bg-gray-100/80 dark:bg-zinc-800/80 rounded-full p-1 gap-1"
    >
      {languages.map((lang) => {
        const isActive = pathname?.startsWith(`/${lang.code}`);

        return (
          <button
            key={lang.code}
            onClick={() => handleLanguageChange(lang.code)}
            className={`text-xs font-bold px-3 py-1.5 rounded-full transition-all cursor-pointer ${
              isActive
                ? "bg-blue-600 text-white shadow-md scale-105"
                : "text-gray-500 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-zinc-700"
            }`}
          >
            {lang.label}
          </button>
        );
      })}
    </div>
  );
}
// === –ö–û–ù–ï–¶ –ë–õ–û–ö–ê ===
</file>

<file path="psy-front/components/ui/BottomBar.tsx">
"use client";

import Link from "next/link";
import { usePathname } from "next/navigation";
import { triggerHaptic } from "@/lib/haptic";

const translations = {
  ru: { home: "–ì–ª–∞–≤–Ω–∞—è", fav: "–ò–∑–±—Ä–∞–Ω–Ω–æ–µ", menu: "–ú–µ–Ω—é" },
  en: { home: "Home", fav: "Bookmarks", menu: "Menu" },
  ua: { home: "–ì–æ–ª–æ–≤–Ω–∞", fav: "–û–±—Ä–∞–Ω–µ", menu: "–ú–µ–Ω—é" },
  pl: { home: "G≈Ç√≥wna", fav: "Zak≈Çadki", menu: "Menu" },
  de: { home: "Home", fav: "Favoriten", menu: "Men√º" },
};

export default function BottomBar() {
  const pathname = usePathname();
  const currentLang = (pathname?.split("/")[1] || "ru") as keyof typeof translations;
  const t = translations[currentLang] || translations.ru;

  const isActive = (path: string) => {
    if (path === `/${currentLang}`) {
      return pathname === `/${currentLang}` || pathname === `/${currentLang}/`;
    }
    return pathname?.startsWith(path);
  };

  return (
    <nav id="mobile-bottom-bar" className="md:hidden fixed bottom-0 left-0 right-0 z-50 bg-white/80 dark:bg-[#0a0a0a]/80 backdrop-blur-lg border-t border-gray-100 dark:border-zinc-800 pb-[env(safe-area-inset-bottom)]">
      <div className="flex items-center justify-around h-16 px-4">
        
        <Link 
          href={`/${currentLang}`} 
          onClick={() => triggerHaptic('light')}
          className={`flex flex-col items-center justify-center w-full h-full space-y-1 transition-colors ${isActive(`/${currentLang}`) ? 'text-blue-600 dark:text-blue-400' : 'text-gray-400 dark:text-gray-500'}`}
        >
          <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" />
          </svg>
          <span className="text-[10px] font-bold">{t.home}</span>
        </Link>

        <Link 
          href={`/${currentLang}/bookmarks`} 
          onClick={() => triggerHaptic('light')}
          className={`flex flex-col items-center justify-center w-full h-full space-y-1 transition-colors ${isActive(`/${currentLang}/bookmarks`) ? 'text-blue-600 dark:text-blue-400' : 'text-gray-400 dark:text-gray-500'}`}
        >
          <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-3.5L5 21V5z" />
          </svg>
          <span className="text-[10px] font-bold">{t.fav}</span>
        </Link>

        <Link 
          href={`/${currentLang}/menu`} 
          onClick={() => triggerHaptic('light')}
          className={`flex flex-col items-center justify-center w-full h-full space-y-1 transition-colors ${isActive(`/${currentLang}/menu`) ? 'text-blue-600 dark:text-blue-400' : 'text-gray-400 dark:text-gray-500'}`}
        >
          <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M4 6h16M4 12h16M4 18h16" />
          </svg>
          <span className="text-[10px] font-bold">{t.menu}</span>
        </Link>

      </div>
    </nav>
  );
}
</file>

<file path="psy-front/components/ui/Header.tsx">
// === –ù–ê–ß–ê–õ–û –ë–õ–û–ö–ê: Header ===
"use client";

import Link from "next/link";
import { usePathname } from "next/navigation";
import { ThemeToggle } from "./ThemeToggle"; 
import LanguageSwitcher from "../LanguageSwitcher";

const translations = {
  ru: { bookmarks: "–ó–∞–∫–ª–∞–¥–∫–∏" },
  en: { bookmarks: "Bookmarks" },
  ua: { bookmarks: "–ó–∞–∫–ª–∞–¥–∫–∏" },
  pl: { bookmarks: "Zak≈Çadki" },
  de: { bookmarks: "Lesezeichen" },
};

export default function Header() {
  const pathname = usePathname();
  const lang = (pathname?.split("/")[1] || "ru") as keyof typeof translations;
  // –î–æ–±–∞–≤–ª–µ–Ω–∞ –∑–∞—â–∏—Ç–∞ –æ—Ç –ø–∞–¥–µ–Ω–∏—è, –µ—Å–ª–∏ —è–∑—ã–∫ –≤ URL –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π
  const t = translations[lang as keyof typeof translations] || translations.ru;

  return (
    <header id="desktop-header" className="fixed top-0 left-0 right-0 z-50 bg-background/80 backdrop-blur-md border-b border-gray-200 dark:border-zinc-800 hidden md:flex items-center h-16">
      <div className="layout-container flex items-center justify-between w-full">
        
        <Link href={`/${lang}`} className="text-xl font-black tracking-tighter text-foreground">
          HEALTH<span className="text-blue-600 font-normal">PSY</span>
        </Link>

        <nav className="flex items-center gap-6 text-sm font-bold text-gray-600 dark:text-gray-300">
          {/* –°—Å—ã–ª–∫–∞ –Ω–∞ –ø–æ–∏—Å–∫ —É–¥–∞–ª–µ–Ω–∞ */}
          
          <Link href={`/${lang}/bookmarks`} className="hover:text-blue-600 transition-colors">
            {t.bookmarks}
          </Link>
          
          <div className="border-l border-gray-300 dark:border-zinc-700 pl-6 flex items-center gap-4">
            <LanguageSwitcher />
            <ThemeToggle />
          </div>
        </nav>
        
      </div>
    </header>
  );
}
// === –ö–û–ù–ï–¶ –ë–õ–û–ö–ê ===
</file>

<file path="psy-front/lib/sanity.ts">
// === –ù–ê–ß–ê–õ–û –ë–õ–û–ö–ê: Sanity Client Setup ===
import { createClient } from "next-sanity";

export const client = createClient({
  projectId: process.env.NEXT_PUBLIC_SANITY_PROJECT_ID,
  dataset: process.env.NEXT_PUBLIC_SANITY_DATASET,
  apiVersion: "2024-02-16", 
  useCdn: false, // üëà –°–¢–ê–í–ò–ú FALSE! –û—Ç–∫–ª—é—á–∞–µ–º –∫—ç—à, —á—Ç–æ–±—ã –ø–æ—Å—Ç—ã –ø–æ—è–≤–ª—è–ª–∏—Å—å –º–≥–Ω–æ–≤–µ–Ω–Ω–æ
});
// === –ö–û–ù–ï–¶ –ë–õ–û–ö–ê ===
</file>

<file path="psy-admin/schemaTypes/post.ts">
// === –ù–ê–ß–ê–õ–û –ë–õ–û–ö–ê: Sanity Post Schema Fixed ===
import {defineField, defineType} from 'sanity'

export default defineType({
  name: 'post',
  title: '–°—Ç–∞—Ç—å—è (Post)',
  type: 'document',
  fields: [
    defineField({
      name: 'language',
      title: 'üåê –Ø–∑—ã–∫ —Å—Ç–∞—Ç—å–∏',
      type: 'string',
      readOnly: true, // –ü–ª–∞–≥–∏–Ω –∏–Ω—Ç–µ—Ä–Ω–∞—Ü–∏–æ–Ω–∞–ª–∏–∑–∞—Ü–∏–∏ —Å–∞–º —É–ø—Ä–∞–≤–ª—è–µ—Ç —ç—Ç–∏–º –ø–æ–ª–µ–º
    }),
    defineField({
      name: 'title',
      title: '–ó–∞–≥–æ–ª–æ–≤–æ–∫',
      type: 'string',
      validation: (Rule) => Rule.required(),
    }),
    defineField({
      name: 'slug',
      title: 'URL —Å—Ç–∞—Ç—å–∏ (Slug)',
      type: 'slug',
      options: {
        source: 'title',
        maxLength: 96,
      },
      // –ú—ã —É–±—Ä–∞–ª–∏ –≥–ª—é—á–Ω—ã–π –∫–∞—Å—Ç–æ–º–Ω—ã–π isUnique, –ø–ª–∞–≥–∏–Ω –ø–µ—Ä–µ–≤–æ–¥–æ–≤ —Å–∞–º —Å–ª–µ–¥–∏—Ç –∑–∞ —Å–ª–∞–≥–∞–º–∏!
      validation: (Rule) => Rule.required(),
    }),
    defineField({
      name: 'mainImage',
      title: '–ì–ª–∞–≤–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ',
      type: 'image',
      options: { hotspot: true },
    }),
    defineField({
      name: 'publishedAt',
      title: '–î–∞—Ç–∞ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏',
      type: 'datetime',
      initialValue: () => new Date().toISOString(),
    }),
    defineField({
      name: 'category',
      title: '–ö–∞—Ç–µ–≥–æ—Ä–∏—è (–¢–µ–≥)',
      type: 'string',
      options: {
        list: [
          { title: '–¢—Ä–µ–≤–æ–∂–Ω–æ—Å—Ç—å', value: 'anxiety' },
          { title: '–û—Ç–Ω–æ—à–µ–Ω–∏—è', value: 'relationships' },
          { title: '–í—ã–≥–æ—Ä–∞–Ω–∏–µ', value: 'burnout' },
          { title: '–°–∞–º–æ–æ—Ü–µ–Ω–∫–∞', value: 'self-esteem' },
        ],
      },
    }),
    // –í–û–ó–í–†–ê–©–ê–ï–ú –°–¢–ê–†–´–ï –ò–ú–ï–ù–ê –ü–û–õ–ï–ô, –ß–¢–û–ë–´ –°–ü–ê–°–¢–ò –°–¢–ê–†–´–ï –°–¢–ê–¢–¨–ò
    defineField({
      name: 'readingTime',
      title: '‚è≥ –í—Ä–µ–º—è —á—Ç–µ–Ω–∏—è (–º–∏–Ω)',
      type: 'number',
    }),
    defineField({
      name: 'expertReview',
      title: 'üß† –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —ç–∫—Å–ø–µ—Ä—Ç–æ–º ‚úÖ (E-E-A-T)',
      type: 'boolean',
      initialValue: false,
    }),
    defineField({
      name: 'youtubeShorts',
      title: 'YouTube Shorts (–ú—É–ª—å—Ç–∏—è–∑—ã—á–Ω—ã–π)',
      type: 'object',
      fields: [
        { name: 'ru', type: 'url', title: '–í–∏–¥–µ–æ (RU)' },
        { name: 'en', type: 'url', title: '–í–∏–¥–µ–æ (EN)' },
        { name: 'ua', type: 'url', title: '–í–∏–¥–µ–æ (UA)' },
        { name: 'pl', type: 'url', title: '–í–∏–¥–µ–æ (PL)' },
        { name: 'de', type: 'url', title: '–í–∏–¥–µ–æ (DE)' },
      ]
    }),
    defineField({
      name: 'body',
      title: '–¢–µ–∫—Å—Ç —Å—Ç–∞—Ç—å–∏',
      type: 'array',
      of: [
        { type: 'block' },
        { type: 'image', options: { hotspot: true } },
        {
          type: 'object',
          name: 'youtube',
          title: 'YouTube Video',
          fields: [{ name: 'url', type: 'url', title: '–°—Å—ã–ª–∫–∞' }]
        }
      ],
    }),
  ],
  preview: {
    select: {
      title: 'title',
      lang: 'language',
      media: 'mainImage',
    },
    prepare(selection) {
      const {title, lang, media} = selection
      return {
        title: title,
        subtitle: lang ? `–Ø–∑—ã–∫: ${lang.toUpperCase()}` : '–ë–∞–∑–æ–≤–∞—è —Å—Ç–∞—Ç—å—è',
        media: media,
      }
    },
  },
})
// === –ö–û–ù–ï–¶ –ë–õ–û–ö–ê ===
</file>

<file path="psy-front/app/globals.css">
@import "tailwindcss";

@custom-variant dark (&:where(.dark, .dark *));

/* –í v4 –ø–ª–∞–≥–∏–Ω—ã –∏–º–ø–æ—Ä—Ç–∏—Ä—É—é—Ç—Å—è —á–µ—Ä–µ–∑ @plugin, –Ω–æ typography —á–∞—Å—Ç–æ –∏–¥–µ—Ç –≤ –∫–æ–º–ø–ª–µ–∫—Ç–µ –∏–ª–∏ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –∏–Ω–∞—á–µ. 
–ï—Å–ª–∏ @plugin —Ä—É–≥–∞–µ—Ç—Å—è, —É–±–µ–¥–∏—Å—å, —á—Ç–æ –ø–∞–∫–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω: npm install @tailwindcss/typography */
@plugin "@tailwindcss/typography";

/* –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ç–µ–º—ã –≤ v4 —Ç–µ–ø–µ—Ä—å –¥–µ–ª–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ @theme */
@theme {
  --color-background: var(--background);
  --color-foreground: var(--foreground);
}

:root {
  --background: #ffffff;
  --foreground: #111827;
}

.dark {
  --background: #0a0a0a;
  --foreground: #f3f4f6;
}

/* –í–º–µ—Å—Ç–æ @custom-variant –≤ v4 –∏—Å–ø–æ–ª—å–∑—É–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Å–µ–ª–µ–∫—Ç–æ—Ä –∏–ª–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ç–µ–º—ã */

@layer base {
  body {
    background-color: var(--background);
    color: var(--foreground);
    @apply transition-colors duration-500 ease-in-out antialiased;
  }
}

@layer components {
  /* –¢–≤–æ–∏ —Å—Ç–∏–ª–∏ –∫–Ω–æ–ø–æ–∫ –∏ –∫–∞—Ä—Ç–æ—á–µ–∫ –Ω–∏–∂–µ... */
  .btn-primary { @apply inline-flex items-center justify-center px-[32px] py-[16px] bg-blue-600 hover:bg-blue-700 text-white font-bold rounded-2xl transition-all duration-300 shadow-sm active:scale-95; }
  .btn-secondary { @apply inline-flex items-center justify-center px-[32px] py-[16px] bg-gray-100 dark:bg-zinc-800 text-gray-900 dark:text-white font-bold rounded-2xl transition-all duration-300 active:scale-95 hover:bg-gray-200 dark:hover:bg-zinc-700; }
  .tag-pill { @apply inline-flex items-center justify-center px-[24px] py-[12px] bg-white dark:bg-zinc-900 text-gray-700 dark:text-zinc-300 text-sm font-bold rounded-full border border-gray-200 dark:border-zinc-800 hover:border-blue-500 hover:text-blue-600 dark:hover:text-blue-400 transition-all duration-300 active:scale-95 shadow-sm; }
  .input-base { @apply w-full px-[28px] py-[16px] bg-gray-50 dark:bg-zinc-900 border-none ring-1 ring-gray-200 dark:ring-zinc-800 focus:ring-2 focus:ring-blue-500 rounded-[24px] text-gray-900 dark:text-white placeholder-gray-500 transition-all duration-300 outline-none; }
  .card-editorial { @apply p-[24px] bg-white dark:bg-zinc-900 rounded-[24px] border border-gray-100 dark:border-zinc-800 shadow-sm dark:shadow-none transition-all duration-300; }
  .layout-container { @apply max-w-3xl mx-auto px-4 sm:px-6 w-full; }
  }

/* –ö–∞—Å—Ç–æ–º–Ω—ã–π —Å–∫—Ä–æ–ª–ª–±–∞—Ä */
@layer utilities {
  /* –°–∫—Ä—ã–≤–∞–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Å–∫—Ä–æ–ª–ª–±–∞—Ä –¥–ª—è Firefox */
  .custom-scrollbar {
    scrollbar-width: thin;
    scrollbar-color: #d4d4d8 transparent;
  }

  .dark .custom-scrollbar {
    scrollbar-color: #3f3f46 transparent;
  }

  /* –ö–∞—Å—Ç–æ–º–Ω—ã–π —Å–∫—Ä–æ–ª–ª–±–∞—Ä –¥–ª—è Chrome, Safari, Edge */
  .custom-scrollbar::-webkit-scrollbar {
    height: 4px; /* –î–µ–ª–∞–µ–º –µ–≥–æ –µ—â–µ —Ç–æ–Ω—å—à–µ */
  }

  .custom-scrollbar::-webkit-scrollbar-track {
    background: transparent;
  }

  .custom-scrollbar::-webkit-scrollbar-thumb {
    background-color: #e4e4e7; /* –û—á–µ–Ω—å —Å–≤–µ—Ç–ª—ã–π —Å–µ—Ä—ã–π (zinc-200) */
    border-radius: 9999px; /* –ò–¥–µ–∞–ª—å–Ω–æ –∫—Ä—É–≥–ª—ã–π */
  }

  .custom-scrollbar::-webkit-scrollbar-thumb:hover {
    background-color: #a1a1aa; /* –ß—É—Ç—å —Ç–µ–º–Ω–µ–µ –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ (zinc-400) */
  }

  /* –°—Ç–∏–ª–∏ —Å–∫—Ä–æ–ª–ª–±–∞—Ä–∞ –¥–ª—è —Ç–µ–º–Ω–æ–π —Ç–µ–º—ã –≤ WebKit */
  .dark .custom-scrollbar::-webkit-scrollbar-thumb {
    background-color: #27272a; /* –¢–µ–º–Ω–æ-—Å–µ—Ä—ã–π (zinc-800) */
  }

  .dark .custom-scrollbar::-webkit-scrollbar-thumb:hover {
    background-color: #52525b; /* –°–≤–µ—Ç–ª–µ–µ –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ (zinc-600) */
  }
}
</file>

<file path="psy-front/app/layout.tsx">
// === –ù–ê–ß–ê–õ–û –ë–õ–û–ö–ê: Root Layout ===
import type { Metadata, Viewport } from "next"; 
import { Inter } from "next/font/google";
import { ThemeProvider } from "next-themes";
import "./globals.css";
import BottomBar from "@/components/ui/BottomBar"; 
import Header from "@/components/ui/Header"; 

const inter = Inter({ subsets: ["latin", "cyrillic"] });

export const viewport: Viewport = {
  width: "device-width",
  initialScale: 1,
  maximumScale: 1,
  userScalable: false,
  viewportFit: "cover",
};

export const metadata: Metadata = {
  title: "HealthPsy", // –ú–æ–∂–Ω–æ –∑–∞–æ–¥–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å –Ω–∞–∑–≤–∞–Ω–∏–µ
  description: "–¢–≤–æ–π –ø—Ä–æ–≤–æ–¥–Ω–∏–∫ –≤ –º–µ–Ω—Ç–∞–ª—å–Ω–æ–º –º–∏—Ä–µ",
  icons: {
    icon: "/favicon.ico",
    shortcut: "/favicon.ico",
    apple: "/favicon.ico", // –î–ª—è –∏–∫–æ–Ω–æ–∫ –Ω–∞ iPhone
  },
};

export default function RootLayout({
  children,
}: {
  children: React.ReactNode;
}) {
  return (
    <html lang="ru" suppressHydrationWarning>
      <body id="root-body" className={`${inter.className} bg-background text-foreground antialiased`}>
        <ThemeProvider attribute="class" defaultTheme="system" enableSystem>
          
          <div id="app-wrapper" className="relative flex min-h-screen flex-col">
            
            <Header />
            
            {/* –ì–ª–æ–±–∞–ª—å–Ω–∞—è –æ–±–µ—Ä—Ç–∫–∞ –æ—Ç—Å—Ç—É–ø–æ–≤: –∑–∞—â–∏—â–∞–µ—Ç –æ—Ç –Ω–∞–ª–æ–∂–µ–Ω–∏—è Header –∏ BottomBar */}
            <div id="main-content" className="flex-1 pt-20 md:pt-28 pb-24 md:pb-12">
              {children}
            </div>
            
            <BottomBar />
            
          </div>
          
        </ThemeProvider>
      </body>
    </html>
  );
}
// === –ö–û–ù–ï–¶ –ë–õ–û–ö–ê ===
</file>

<file path="psy-front/package.json">
{
  "name": "psy-front",
  "version": "0.1.0",
  "private": true,
  "scripts": {
    "dev": "next dev",
    "build": "next build",
    "start": "next start",
    "lint": "eslint"
  },
  "dependencies": {
    "@portabletext/react": "^6.0.2",
    "@sanity/client": "^7.15.0",
    "@sanity/document-internationalization": "^5.0.1",
    "@sanity/image-url": "^2.0.3",
    "@tailwindcss/typography": "^0.5.19",
    "algoliasearch": "^5.48.1",
    "lucide-react": "^0.564.0",
    "next": "16.1.6",
    "next-sanity": "^12.1.0",
    "next-themes": "^0.4.6",
    "postcss": "^8.5.6",
    "react": "19.2.3",
    "react-dom": "19.2.3",
    "react-instantsearch": "^7.23.2",
    "sanity": "^5.9.0",
    "styled-components": "^6.3.9"
  },
  "devDependencies": {
    "@tailwindcss/postcss": "^4.1.18",
    "@types/node": "^20",
    "@types/react": "^19",
    "@types/react-dom": "^19",
    "eslint": "^9",
    "eslint-config-next": "16.1.6",
    "tailwindcss": "^4.1.18",
    "typescript": "^5"
  }
}
</file>

<file path="psy-front/lib/queries.ts">
// === –ù–ê–ß–ê–õ–û –ë–õ–û–ö–ê: Sanity Queries ===
import { groq } from "next-sanity";

// –°—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∑–∞–ø—Ä–æ—Å –≤—Å–µ—Ö —Å—Ç–∞—Ç–µ–π (–û–±–Ω–æ–≤–ª–µ–Ω –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ —Å—Ç–∞—Ä—ã—Ö –ø–æ—Å—Ç–æ–≤)
export const articlesQuery = groq`*[_type == "post" && (language == $lang || (!defined(language) && $lang == 'ru'))] | order(publishedAt desc) {
  _id,
  title,
  "slug": slug.current,
  category,
  "readTime": coalesce(readingTime, readTime),
  "expert": coalesce(expertReview, expert),
  "mainImage": mainImage.asset->url,
  language
}`;

// –ó–∞–ø—Ä–æ—Å –¥–ª—è –∑–∞–∫–ª–∞–¥–æ–∫: –ü–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç—å–∏ –ø–æ –º–∞—Å—Å–∏–≤—É ID (–û–±–Ω–æ–≤–ª–µ–Ω –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ —Å—Ç–∞—Ä—ã—Ö –ø–æ—Å—Ç–æ–≤)
export const bookmarkedArticlesQuery = groq`*[_type == "post" && _id in $ids && (language == $lang || (!defined(language) && $lang == 'ru'))] | order(publishedAt desc) {
  _id,
  title,
  "slug": slug.current,
  category,
  "readTime": coalesce(readingTime, readTime),
  "expert": coalesce(expertReview, expert),
  "mainImage": mainImage.asset->url,
  language
}`;
// === –ö–û–ù–ï–¶ –ë–õ–û–ö–ê ===
</file>

</files>
